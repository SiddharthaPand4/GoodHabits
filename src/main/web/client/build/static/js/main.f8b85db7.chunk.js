(window.webpackJsonpsynvisionweb=window.webpackJsonpsynvisionweb||[]).push([[0],{248:function(e,t,a){e.exports=a(462)},253:function(e,t,a){},254:function(e,t,a){},462:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a(17),i=a(23),o=a(22),l=a(24),c=a(0),s=a.n(c),u=a(8),d=a.n(u),m=(a(253),a(254),a(463)),h=a(177),g=a(11),f=a(39),v=m.a.Sider,p=h.a.SubMenu,E=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(v,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},s.a.createElement("div",{className:"logo"}),s.a.createElement(h.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},s.a.createElement(h.a.Item,{key:"0"},s.a.createElement(f.b,{to:"/"},s.a.createElement(g.a,{type:"home"}),s.a.createElement("span",{className:"nav-text"},"Home"))),s.a.createElement(h.a.Item,{key:"1",className:"sidebar-nav-link"},s.a.createElement(f.b,{to:"/incidents"},s.a.createElement(g.a,{type:"alert"}),s.a.createElement("span",{className:"nav-text"},"Incidents"))),s.a.createElement(h.a.Item,{key:"6",className:"sidebar-nav-link"},s.a.createElement(f.b,{to:"/anpr"},s.a.createElement(g.a,{type:"box-plot"}),s.a.createElement("span",{className:"nav-text"},"ANPR"))),s.a.createElement(h.a.Item,{key:"2"},s.a.createElement(f.b,{to:"/feed"},s.a.createElement(g.a,{type:"video-camera"}),s.a.createElement("span",{className:"nav-text"},"Feed"))),s.a.createElement(p,{key:"admin",title:s.a.createElement("span",null,s.a.createElement(g.a,{type:"deployment-unit"}),"Admin")},s.a.createElement(h.a.Item,{key:"3"},s.a.createElement(f.b,{to:"/user"},s.a.createElement(g.a,{type:"user"}),s.a.createElement("span",{className:"nav-text"},"Users"))),s.a.createElement(h.a.Item,{key:"4"},s.a.createElement(f.b,{to:"/device"},s.a.createElement(g.a,{type:"laptop"}),s.a.createElement("span",{className:"nav-text"},"Device"))),s.a.createElement(h.a.Item,{key:"5"},s.a.createElement(f.b,{to:"/trigger"},s.a.createElement(g.a,{type:"clock-circle"}),s.a.createElement("span",{className:"nav-text"},"Triggers"))))))}}]),t}(c.Component),y=m.a.Header,b=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(y,{style:{background:"#fff",padding:10}},"\xa0")}}]),t}(c.Component),k=m.a.Footer,C=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(k,{style:{textAlign:"center"}},"SynergyLabs \xa9 2019")}}]),t}(c.Component),O=a(245),j=a(68),S=a(172),T=a.n(S),D=a(228),I=a(34),w=a.n(I);var F=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"Instance",value:function(){var e=new w.a.create({baseURL:"/",timeout:5e3,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem("syntoken"));return t&&(e.headers.Authorization="Bearer "+t.token),e})),w.a.interceptors.response.use(void 0,(function(e){return e.response.config.url.includes("/login")?Promise.reject(e):403===e.response.status?(localStorage.clear(),void(window.location="/login")):401!==e.response.status?Promise.reject(e):void 0})),e}}]),e}().Instance(),x=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getUser",value:function(){return F.get("/api/user/")}},{key:"getUsers",value:function(){return F.get("/api/users")}},{key:"isLoggedIn",value:function(){return JSON.parse(localStorage.getItem("syntoken"))?(console.log("located token, returning true"),!0):(console.log("cannot locate token, returning false"),!1)}},{key:"login",value:function(){var e=Object(D.a)(T.a.mark((function e(t,a){var n,r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.post("/login",JSON.stringify({username:t,password:a}),{headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,console.log("got this response",n),(r=n.data)&&localStorage.setItem("syntoken",JSON.stringify(r)),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),P=function(e){var t=e.component,a=Object(O.a)(e,["component"]);return s.a.createElement(j.b,Object.assign({},a,{render:function(e){return x.isLoggedIn()?s.a.createElement(t,e):s.a.createElement(j.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},_=a(92),N=a(54),z=a(473),M=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(_.a,{gutter:16},s.a.createElement(N.a,{span:12},s.a.createElement(z.a,{title:"Incidents (This Week)",value:24})),s.a.createElement(N.a,{span:12},s.a.createElement(z.a,{title:"Incidents (Last Week)",value:34}))))}}]),t}(c.Component),V=a(18),L=a(468),Y=a(467),B=a(474),A=a(244),H=a(52),R=a(472),J=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getFeeds",value:function(){return w.a.get("/api/feeds")}},{key:"getFeed",value:function(e){return w.a.get("/api/feed/"+e.ID)}},{key:"addFeed",value:function(e){return w.a.post("/api/feed/",e)}},{key:"removeFeed",value:function(e){return w.a.delete("/api/feed/"+e.ID)}},{key:"startFeed",value:function(e){return w.a.get("/api/feed/"+e.ID+"/start")}},{key:"stopFeed",value:function(e){return w.a.get("/api/feed/"+e.ID+"/stop")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),q=a(76),G=L.a.Text,U=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,feeds:{}},q.EventBus.subscribe("feed-refresh",(function(e){return a.refresh()})),a.removeFeed=a.removeFeed.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;J.getFeeds().then((function(t){e.setState({feeds:t.data,loading:!1})}))}},{key:"removeFeed",value:function(e){var t=this;J.removeFeed(e).then((function(){t.refresh()}))}},{key:"startFeed",value:function(e){var t=this;J.startFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"stopFeed",value:function(e){var t=this;J.stopFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"render",value:function(){var e=this,t=this.state.feeds;!this.state.loading&&this.state.feeds&&0!==this.state.feeds.length||(t=[]);var a=Y.a.create({name:"feed_form"})(W);return s.a.createElement(_.a,{gutter:16},t.map((function(t,a){return s.a.createElement(N.a,{span:8,key:a},s.a.createElement(B.a,{title:s.a.createElement(A.a,{color:"#f50"},t.site,"/",t.location,"/",t.name),cover:s.a.createElement("img",{alt:"feedview",src:"/api/feed/"+t.ID+"/view"}),bordered:!0,actions:[s.a.createElement(H.a,{onClick:function(){e.startFeed(t)}},"Start"),s.a.createElement(H.a,{onClick:function(){e.stopFeed(t)}},"Stop"),s.a.createElement(H.a,{onClick:function(){e.removeFeed(t)}},"Delete")]}))})),s.a.createElement(N.a,{span:8,key:-1},s.a.createElement(B.a,{bordered:!0},s.a.createElement(a,null))))}}]),t}(c.Component);var W=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t,a=this.props.form,n={};n.url=a.getFieldValue("url"),n.site=a.getFieldValue("site"),n.location=a.getFieldValue("location"),n.name=a.getFieldValue("name"),n.url||(t="Missing url"),n.site||(t="Missing site"),n.location||(t="Missing location"),n.name||(t="Missing name"),t?this.setState({validationError:t}):(console.log("saving feed",n),this.setState({submitted:!0,loading:!0}),J.addFeed(n).then((function(e){q.EventBus.publish("feed-refresh",{})})))}},{key:"render",value:function(){var e,t=this.props.form,a=t.getFieldDecorator,n=t.getFieldsError,r=this.state.validationError;return s.a.createElement(Y.a,{onSubmit:this.handleSubmit},s.a.createElement(Y.a.Item,null,a("url",{rules:[{required:!0,message:"enter feed url!"}]})(s.a.createElement(R.a,{addonBefore:"Feed\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"rtsp://"}))),s.a.createElement(Y.a.Item,null,a("site",{rules:[{required:!0,message:"enter site!"}]})(s.a.createElement(R.a,{addonBefore:"Site\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"Site (e.g. gurgaon)"}))),s.a.createElement(Y.a.Item,null,a("location",{rules:[{required:!0,message:"enter location!"}]})(s.a.createElement(R.a,{addonBefore:"Location",placeholder:"Location (e.g. 9th floor)"}))),s.a.createElement(Y.a.Item,null,a("name",{rules:[{required:!0,message:"enter name!"}]})(s.a.createElement(R.a,{addonBefore:"Name\xa0\xa0\xa0\xa0",placeholder:"Name (e.g. front gate )"}))),s.a.createElement(H.a,{htmlType:"submit",type:"primary",disabled:(e=n(),Object.keys(e).some((function(t){return e[t]})))},"Add"),r&&s.a.createElement(G,{type:"danger"},r))}}]),t}(c.Component),K=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getDevice",value:function(){return w.a.get("/api/device")}},{key:"getDeviceConfig",value:function(){return w.a.get("/api/device/config")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Q=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,device:{}},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;K.getDevice().then((function(t){e.setState({device:t.data,loading:!1})}))}},{key:"render",value:function(){var e=this.state.loading,t=this.state.device;return e?s.a.createElement("div",null,"Loading.."):s.a.createElement("div",null,s.a.createElement(B.a,{title:"Device details",style:{width:300},extra:s.a.createElement(f.b,{to:"/device/conf"},s.a.createElement(g.a,{type:"setting"}))},s.a.createElement("p",null,"ID: ",t.fingerprint),s.a.createElement("p",null,"Name:",t.name),s.a.createElement("p",null,"Model:",t.model),s.a.createElement("p",null,"License:",t.license),s.a.createElement("p",null,"Status: ",t.status),s.a.createElement("p",null,"RegisteredTo: ",t.registeredTo)))}}]),t}(c.Component),$=a(465),X=a(464),Z=$.a.Column,ee=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,users:[]},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;x.getUsers().then((function(t){e.setState({users:t.data,loading:!1})}))}},{key:"render",value:function(){return s.a.createElement($.a,{dataSource:this.state.users},s.a.createElement(Z,{title:"Username",dataIndex:"username",key:"username",render:function(e,t){return s.a.createElement("span",null,s.a.createElement("a",{href:"user/"+t.ID},e))}}),s.a.createElement(Z,{title:"Email",dataIndex:"email",key:"email"}),s.a.createElement(Z,{title:"Token",dataIndex:"token",key:"token"}),s.a.createElement(Z,{title:"Action",key:"action",render:function(e,t){return s.a.createElement("span",null,s.a.createElement("a",null,"Edit ",t.lastName),s.a.createElement(X.a,{type:"vertical"}),s.a.createElement("a",null,"Delete"))}}))}}]),t}(c.Component),te=a(175),ae=te.a.TabPane,ne=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,deviceconfig:{}},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;K.getDeviceConfig().then((function(t){e.setState({deviceconfig:t.data,loading:!1})}))}},{key:"onTabChange",value:function(e){console.log("tab changed",e)}},{key:"render",value:function(){return s.a.createElement(te.a,{defaultActiveKey:"1",onChange:this.onTabChange},s.a.createElement(ae,{tab:"Feed",key:"common"},"Feed details"),s.a.createElement(ae,{tab:"Basic Intrusion",key:"bi"},"Basic Intrusion"),s.a.createElement(ae,{tab:"Advanced Intrusion",key:"ai"},"Advanced Intrusion"))}}]),t}(c.Component),re=a(44),ie=Object(re.a)(),oe=L.a.Text,le=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){x.isLoggedIn()&&ie.push("/")}},{key:"render",value:function(){var e=Y.a.create({name:"login_form"})(ce);return s.a.createElement(e,null)}}]),t}(c.Component),ce=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.form,n=a.getFieldValue("username"),r=a.getFieldValue("password");this.setState({submitted:!0}),n&&r&&(this.setState({loading:!0}),x.login(n,r).then((function(e){ie.push("/"),q.EventBus.publish("login-logout",{})})).catch((function(e){t.setState({loginError:"Something went wrong, please try again",loading:!1})})))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.loginError;return s.a.createElement(_.a,null,s.a.createElement(N.a,{span:8,offset:8},s.a.createElement("h4",null,"Login"),s.a.createElement(Y.a,{onSubmit:this.handleSubmit,className:"login-form"},s.a.createElement(Y.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(s.a.createElement(R.a,{prefix:s.a.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),s.a.createElement(Y.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(s.a.createElement(R.a,{prefix:s.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),s.a.createElement(Y.a.Item,null,s.a.createElement(H.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))),t&&s.a.createElement(oe,{type:"danger"},t)))}}]),t}(c.Component),se=Object(j.g)(le),ue=a(129),de=a(470),me=a(471),he=a(93),ge=a(466),fe=a(243),ve=a(242),pe=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getIncidents",value:function(e){return F.post("/api/incidents",e)}},{key:"archiveIncident",value:function(e){return F.delete("/api/incident/"+e.ID)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Ee=a(173),ye=a.n(Ee),be=a(69),ke=a.n(be);function Ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Oe=$.a.Column,je=($.a.ColumnGroup,de.a.Panel),Se=H.a.Group,Te=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,layout:"table",incidents:{},filter:{page:1,pageSize:10}},a.handleDone=a.handleDone.bind(Object(V.a)(a)),a.archiveIncident=a.archiveIncident.bind(Object(V.a)(a)),a.refresh=a.refresh.bind(Object(V.a)(a)),a.onFromDateChange=a.onFromDateChange.bind(Object(V.a)(a)),a.onFromTimeChange=a.onFromTimeChange.bind(Object(V.a)(a)),a.onToDateChange=a.onToDateChange.bind(Object(V.a)(a)),a.onToTimeChange=a.onToTimeChange.bind(Object(V.a)(a)),a.onPageChange=a.onPageChange.bind(Object(V.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;pe.getIncidents(this.state.filter).then((function(t){e.setState({incidents:t.data,loading:!1})}))}},{key:"refreshNow",value:function(e){var t=this;pe.getIncidents(e).then((function(a){t.setState({incidents:a.data,loading:!1,filter:e})}))}},{key:"archiveIncident",value:function(e){var t=this;pe.archiveIncident(e).then((function(){t.refresh()}))}},{key:"changeLayout",value:function(e){this.setState({layout:e})}},{key:"showVideo",value:function(e){ye.a.canPlay("/api/incident/video/"+this.state.videoid+"/video.mp4");this.setState({videoVisible:!0,videoid:e})}},{key:"handleDone",value:function(){this.setState({videoVisible:!1,videoid:""})}},{key:"onFromDateChange",value:function(e){var t=this.state.filter;t.fromDate=e.format("YYYY-MM-DD"),this.setState({filter:t})}},{key:"onFromTimeChange",value:function(e){var t=this.state.filter;t.fromTime=e.format("HH:mm:ss"),this.setState({filter:t})}},{key:"onToDateChange",value:function(e){var t=this.state.filter;t.toDate=e.format("YYYY-MM-DD"),this.setState({filter:t})}},{key:"onToTimeChange",value:function(e){var t=this.state.filter;t.toTime=e.format("HH:mm:ss"),this.setState({filter:t})}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"render",value:function(){var e=this,t=this.state.layout;return s.a.createElement("div",null,s.a.createElement(me.a,{title:"Video",visible:this.state.videoVisible,onOk:this.handleDone,onCancel:this.handleDone},this.state.videoVisible?s.a.createElement(ye.a,{controls:!0,url:"/api/incident/video/"+this.state.videoid+"/video.mp4",width:"300"}):s.a.createElement("div",null,s.a.createElement(he.a,null))),s.a.createElement(de.a,{bordered:!1,defaultActiveKey:["1","2"]},s.a.createElement(je,{header:"Filter",key:"1"},s.a.createElement("span",null,"From: "),s.a.createElement(ge.a,{onChange:this.onFromDateChange}),"\xa0\xa0",s.a.createElement(fe.a,{minuteStep:15,secondStep:60,onChange:this.onFromTimeChange}),"\xa0\xa0",s.a.createElement("span",null,"To: "),s.a.createElement(ge.a,{onChange:this.onToDateChange}),"\xa0\xa0",s.a.createElement(fe.a,{minuteStep:15,secondStep:60,onChange:this.onToTimeChange}),"\xa0\xa0",s.a.createElement(Se,null,s.a.createElement(H.a,{type:"list"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("list")}}),s.a.createElement(H.a,{type:"table"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("table")}})),"\xa0\xa0",s.a.createElement(H.a,{onClick:function(){e.refresh()}},s.a.createElement(g.a,{type:"reload"}),"Reload")),s.a.createElement(je,{header:"Incidents",key:"2"},"table"===t?this.renderGrid():this.renderTable())))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.incidents||0===this.state.incidents.Total)return s.a.createElement(he.a,{description:!1});var t=this.state.incidents.Incidents,a=this.state.incidents.Total;return s.a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},s.a.createElement(_.a,null,s.a.createElement(N.a,null,s.a.createElement(ve.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,defaultCurrent:1,total:a}))),s.a.createElement(_.a,{gutter:16},t.map((function(t,a){return s.a.createElement(N.a,{span:8,key:a},s.a.createElement(B.a,{title:s.a.createElement("div",null,s.a.createElement(A.a,{color:"#f50"},t.event_type),s.a.createElement(A.a,{color:"#2db7f5"},t.event_date),s.a.createElement(A.a,{color:"#87d068"},s.a.createElement("span",null,s.a.createElement(ke.a,{format:"LTS"},t.event_start)),s.a.createElement(g.a,{type:"right",hidden:!0}),s.a.createElement("span",{hidden:!0},s.a.createElement(ke.a,{format:"LTS"},t.event_end))),s.a.createElement(A.a,{color:"#108ee9",hidden:!0},t.event_duration,"s")),bordered:!0,cover:s.a.createElement("img",{alt:"incident image",src:"/api/incident/image/"+t.image_id+"/image.jpg"}),actions:[s.a.createElement(g.a,{type:"right",key:"play",onClick:function(){return e.showVideo(t.video_id)}}),s.a.createElement(g.a,{type:"edit",key:"edit"}),s.a.createElement(g.a,{type:"delete",key:"delete",onClick:function(){return e.archiveIncident(t)}})]}))}))))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.incidents||0===this.state.incidents.Total)return s.a.createElement(he.a,{description:!1});var t=this.state.incidents.Incidents,a=this.state.incidents.Total,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ce(a,!0).forEach((function(t){Object(ue.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ce(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return s.a.createElement($.a,{dataSource:t,pagination:n},s.a.createElement(Oe,{title:"ID",dataIndex:"ID",key:"ID"}),s.a.createElement(Oe,{title:"Type",dataIndex:"event_type",key:"event_type"}),s.a.createElement(Oe,{title:"Date",dataIndex:"event_date",key:"event_date"}),s.a.createElement(Oe,{title:"Time",dataIndex:"event_start",key:"event_start",render:function(e){return s.a.createElement(ke.a,{format:"LTS"},e)}}),s.a.createElement(Oe,{title:"Duration",dataIndex:"event_duration",key:"event_duration",render:function(e){return s.a.createElement("span",null,e,"s")}}),s.a.createElement(Oe,{title:"Time",dataIndex:"event_start",key:"event_start",render:function(t,a){return s.a.createElement("span",null,s.a.createElement("a",{onClick:function(){return e.showVideo(a.video_id)}},"Play"),s.a.createElement(X.a,{type:"vertical"}),s.a.createElement("a",{onClick:function(){return e.archiveIncident(a)}},"Delete"))}}))}}]),t}(c.Component),De=a(103),Ie=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getTrigger",value:function(){return w.a.get("/api/trigger/")}},{key:"getTriggers",value:function(){return w.a.get("/api/triggers")}},{key:"createTrigger",value:function(e){return w.a.post("/api/trigger/",e)}},{key:"saveTrigger",value:function(e){return w.a.put("/api/trigger/"+e.ID,e)}},{key:"deleteTrigger",value:function(e){return w.a.delete("/api/trigger/"+e.ID)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),we=a(469),Fe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a.onChange0=a.onChange0.bind(Object(V.a)(a)),a.onChange1=a.onChange1.bind(Object(V.a)(a)),a.onChange2=a.onChange2.bind(Object(V.a)(a)),a.onChange3=a.onChange3.bind(Object(V.a)(a)),a.onChange4=a.onChange4.bind(Object(V.a)(a)),a.onChange5=a.onChange5.bind(Object(V.a)(a)),a.onChange6=a.onChange6.bind(Object(V.a)(a)),a.onChangeValue=a.onChangeValue.bind(Object(V.a)(a)),a.saveTrigger=a.saveTrigger.bind(Object(V.a)(a)),a.deleteTrigger=a.deleteTrigger.bind(Object(V.a)(a)),a.setName=a.setName.bind(Object(V.a)(a)),a.state={trigger:a.props.trigger,changed:!1},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"onChange0",value:function(e){this.onChangeValue(0,e)}},{key:"onChange1",value:function(e){this.onChangeValue(1,e)}},{key:"onChange2",value:function(e){this.onChangeValue(2,e)}},{key:"onChange3",value:function(e){this.onChangeValue(3,e)}},{key:"onChange4",value:function(e){this.onChangeValue(4,e)}},{key:"onChange5",value:function(e){this.onChangeValue(5,e)}},{key:"onChange6",value:function(e){this.onChangeValue(6,e)}},{key:"onChangeValue",value:function(e,t){var a=this.state.trigger;a.TriggerDays[e].Start=t[0],a.TriggerDays[e].End=t[1],this.setState({trigger:a,changed:!0})}},{key:"saveTrigger",value:function(){this.state.trigger.new?Ie.createTrigger(this.state.trigger):Ie.saveTrigger(this.state.trigger)}},{key:"NewTrigger",value:function(){for(var e={name:"New",TriggerDays:[],new:!0},t=0;t<7;t++)e.TriggerDays.push({Start:0,End:24,Day:t});this.setState({trigger:e,changed:!0})}},{key:"setName",value:function(e,t){var a=this.state.trigger;a.name=e.target.value,this.setState({trigger:a,changed:!0})}},{key:"deleteTrigger",value:function(){Ie.deleteTrigger(this.state.trigger)}},{key:"ChangeTrigger",value:function(e){this.setState({trigger:e,changed:!1})}},{key:"render",value:function(){var e=this.state.trigger,t=this.state.changed;if(!e)return s.a.createElement("div",null,"Waiting..");for(var a={},n=12;n<=24;n++){a[n-12]=n+":00"}for(var r=0;r<=12;r++){a[r+12]=(r<10?"0":"")+r+":00"}e.TriggerDays.map((function(e,t){var a=e.Start,n=e.End;a>n&&(e.Start=a-12,e.End=n+12)}));var i=e.TriggerDays;return s.a.createElement("div",null,e.new?s.a.createElement(R.a,{placeholder:"Name",onChange:this.setName}):s.a.createElement("span",null,e.ID," - ",e.name),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[0].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[0].Start,i[0].End],onChange:this.onChange0})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[1].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[1].Start,i[1].End],onChange:this.onChange1})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[2].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[2].Start,i[2].End],onChange:this.onChange2})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[3].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[3].Start,i[3].End],onChange:this.onChange3})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[4].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[4].Start,i[4].End],onChange:this.onChange4})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[5].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[5].Start,i[5].End],onChange:this.onChange5})),s.a.createElement("div",null,s.a.createElement("span",null,this.days[i[6].Day]),s.a.createElement(we.a,{min:0,max:24,range:!0,marks:a,value:[i[6].Start,i[6].End],onChange:this.onChange6})),s.a.createElement(H.a,{type:"primary",disabled:!t,onClick:this.saveTrigger},"Save"),s.a.createElement(H.a,{type:"link",disabled:t,onClick:this.deleteTrigger},"Delete"))}}]),t}(c.Component),xe=De.a.Option,Pe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,triggers:[]},a.tsRef=s.a.createRef(),a.handleChange=a.handleChange.bind(Object(V.a)(a)),a.newTrigger=a.newTrigger.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;Ie.getTriggers().then((function(t){e.setState({triggers:t.data,selected:t.data[0].ID,selectedt:t.data[0],loading:!1})}))}},{key:"newTrigger",value:function(){this.tsRef.current.NewTrigger()}},{key:"handleChange",value:function(e){console.log("changing to ...",e);for(var t=0;t<this.state.triggers.length;t++)if(console.log("checking:",this.state.triggers[t].ID),e==this.state.triggers[t].ID)return console.log("selected:",e),this.tsRef.current.ChangeTrigger(this.state.triggers[t]),void this.setState({selected:e,selectedt:this.state.triggers[t]});console.log("cant select:(")}},{key:"render",value:function(){var e=this.state.selected,t=this.state.selectedt,a=this.state.triggers;this.state.loading&&(a=[]);var n="";t&&(n=t.Name),console.log("SN",n,e,t);var r=s.a.createElement("div",null,s.a.createElement(De.a,{style:{width:120},onChange:this.handleChange},a.map((function(e,t){return s.a.createElement(xe,{key:e.ID},e.name)}))),"\xa0",s.a.createElement(H.a,{type:"primary",onClick:this.newTrigger},"New"));return t?s.a.createElement("div",null,r,s.a.createElement(Fe,{trigger:t,ref:this.tsRef})):r}}]),t}(c.Component),_e=H.a.Group,Ne=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,layout:"table",filter:{page:1,pageSize:10}},a.onFromDateChange=a.onFromDateChange.bind(Object(V.a)(a)),a.onFromTimeChange=a.onFromTimeChange.bind(Object(V.a)(a)),a.onToDateChange=a.onToDateChange.bind(Object(V.a)(a)),a.onToTimeChange=a.onToTimeChange.bind(Object(V.a)(a)),a.onPageChange=a.onPageChange.bind(Object(V.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"changeLayout",value:function(e){this.setState({layout:e})}},{key:"onFromDateChange",value:function(e){var t=this.state.filter;t.fromDate=e.format("YYYY-MM-DD"),this.setState({filter:t})}},{key:"onFromTimeChange",value:function(e){var t=this.state.filter;t.fromTime=e.format("HH:mm:ss"),this.setState({filter:t})}},{key:"onToDateChange",value:function(e){var t=this.state.filter;t.toDate=e.format("YYYY-MM-DD"),this.setState({filter:t})}},{key:"onToTimeChange",value:function(e){var t=this.state.filter;t.toTime=e.format("HH:mm:ss"),this.setState({filter:t})}},{key:"render",value:function(){var e=this,t=this.state.layout;return s.a.createElement("div",null,s.a.createElement("span",null,"From: "),s.a.createElement(ge.a,{onChange:this.onFromDateChange}),"\xa0\xa0",s.a.createElement(fe.a,{minuteStep:15,secondStep:60,onChange:this.onFromTimeChange}),"\xa0\xa0",s.a.createElement("span",null,"To: "),s.a.createElement(ge.a,{onChange:this.onToDateChange}),"\xa0\xa0",s.a.createElement(fe.a,{minuteStep:15,secondStep:60,onChange:this.onToTimeChange}),"\xa0\xa0",s.a.createElement(_e,null,s.a.createElement(H.a,{type:"list"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("list")}}),s.a.createElement(H.a,{type:"table"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("table")}})),"\xa0\xa0",s.a.createElement(H.a,{onClick:function(){e.refresh()}},s.a.createElement(g.a,{type:"reload"}),"Reload"))}}]),t}(c.Component),ze=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getEvents",value:function(){return F.get("/api/anpr/events")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance();function Me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ve=$.a.Column,Le=de.a.Panel,Ye=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loading:!0,layout:"table",events:{}},a.refresh=a.refresh.bind(Object(V.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;ze.getEvents(this.state.filter).then((function(t){e.setState({events:t.data,loading:!1})}))}},{key:"render",value:function(){var e=this.state.layout;return s.a.createElement("div",null,"ANPR",s.a.createElement(de.a,{bordered:!1,defaultActiveKey:["1","2"]},s.a.createElement(Le,{header:"Filter",key:"1"},s.a.createElement(Ne,null)),s.a.createElement(Le,{header:"Events",key:"2"},"table"===e?this.renderGrid():this.renderTable())))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.incidents||0===this.state.incidents.Total)return s.a.createElement(he.a,{description:!1});var t=this.state.incidents.Incidents,a=this.state.incidents.Total;return s.a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},s.a.createElement(_.a,null,s.a.createElement(N.a,null,s.a.createElement(ve.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,defaultCurrent:1,total:a}))),s.a.createElement(_.a,{gutter:16},t.map((function(t,a){return s.a.createElement(N.a,{span:8,key:a},s.a.createElement(B.a,{title:s.a.createElement("div",null,s.a.createElement(A.a,{color:"#f50"},t.event_type),s.a.createElement(A.a,{color:"#2db7f5"},t.event_date),s.a.createElement(A.a,{color:"#87d068"},s.a.createElement("span",null,s.a.createElement(ke.a,{format:"LTS"},t.event_start)),s.a.createElement(g.a,{type:"right",hidden:!0}),s.a.createElement("span",{hidden:!0},s.a.createElement(ke.a,{format:"LTS"},t.event_end))),s.a.createElement(A.a,{color:"#108ee9",hidden:!0},t.event_duration,"s")),bordered:!0,cover:s.a.createElement("img",{alt:"incident",src:"/api/incident/image/"+t.image_id+"/image.jpg"}),actions:[s.a.createElement(g.a,{type:"right",key:"play",onClick:function(){return e.showVideo(t.video_id)}}),s.a.createElement(g.a,{type:"edit",key:"edit"}),s.a.createElement(g.a,{type:"delete",key:"delete",onClick:function(){return e.archiveIncident(t)}})]}))}))))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.events||0===this.state.events.Total)return s.a.createElement(he.a,{description:!1});var t=this.state.incidents.events,a=this.state.incidents.Total,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(a,!0).forEach((function(t){Object(ue.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Me(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return s.a.createElement($.a,{dataSource:t,pagination:n},s.a.createElement(Ve,{title:"ID",dataIndex:"ID",key:"ID"}),s.a.createElement(Ve,{title:"Type",dataIndex:"event_type",key:"event_type"}),s.a.createElement(Ve,{title:"Date",dataIndex:"event_date",key:"event_date"}),s.a.createElement(Ve,{title:"Time",dataIndex:"event_start",key:"event_start",render:function(e){return s.a.createElement(ke.a,{format:"LTS"},e)}}),s.a.createElement(Ve,{title:"Duration",dataIndex:"event_duration",key:"event_duration",render:function(e){return s.a.createElement("span",null,e,"s")}}),s.a.createElement(Ve,{title:"Time",dataIndex:"event_start",key:"event_start",render:function(t,a){return s.a.createElement("span",null,s.a.createElement("a",{onClick:function(){return e.showVideo(a.video_id)}},"Play"),s.a.createElement(X.a,{type:"vertical"}),s.a.createElement("a",{onClick:function(){return e.archiveIncident(a)}},"Delete"))}}))}}]),t}(c.Component),Be=m.a.Content,Ae=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={loggedIn:!1},q.EventBus.subscribe("login-logout",(function(e){return a.refreshMenu(e)})),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refreshMenu()}},{key:"refreshMenu",value:function(){this.setState({loggedIn:x.isLoggedIn()})}},{key:"render",value:function(){var e=this.state.loggedIn,t=e?s.a.createElement(E,null):null,a=e?s.a.createElement(b,{isLoggedIn:e}):null;return s.a.createElement("div",{className:"App"},s.a.createElement(m.a,null,t,s.a.createElement(m.a,null,a,s.a.createElement(Be,{style:{margin:"24px 16px 0"}},s.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},s.a.createElement(j.b,{path:"/login",exact:!0,component:se}),s.a.createElement(P,{path:"/",exact:!0,component:M}),s.a.createElement(P,{path:"/incidents",exact:!0,component:Te}),s.a.createElement(P,{path:"/anpr",exact:!0,component:Ye}),s.a.createElement(P,{path:"/user",exact:!0,component:ee}),s.a.createElement(P,{path:"/feed",exact:!0,component:U}),s.a.createElement(P,{path:"/trigger",exact:!0,component:Pe}),s.a.createElement(P,{path:"/device",exact:!0,component:Q}),s.a.createElement(P,{path:"/device/conf",exact:!0,component:ne}))),s.a.createElement(C,null))))}}]),t}(c.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var He=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(o.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,null,s.a.createElement(j.d,null,s.a.createElement(Ae,null)))}}]),t}(s.a.Component);d.a.render(s.a.createElement(He,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,t){e.exports={EventBus:{events:{},publish:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))},subscribe:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}}}}},[[248,1,2]]]);
//# sourceMappingURL=main.f8b85db7.chunk.js.map