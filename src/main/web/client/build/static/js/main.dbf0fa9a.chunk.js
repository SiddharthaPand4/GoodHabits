(window.webpackJsonpsynvisionweb=window.webpackJsonpsynvisionweb||[]).push([[0],{279:function(e,t,a){e.exports=a(522)},284:function(e,t,a){},286:function(e,t,a){},495:function(e,t,a){},522:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a(15),i=a(20),l=a(19),s=a(21),o=a(0),c=a.n(o),u=a(9),h=a.n(u),d=(a(284),a(285),a(286),a(523)),g=a(200),m=a(12),p=a(39),f=a(190),v=a.n(f),b=a(256),y=a(191),E=a.n(y);var k=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"Instance",value:function(){var e=new E.a.create({baseURL:"/",timeout:5e3,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem("syntoken"));return t&&(e.headers.Authorization="Bearer "+t.token),e})),E.a.interceptors.response.use(void 0,(function(e){return e.response.config.url.includes("/login")?Promise.reject(e):403===e.response.status?(console.log("I am at 403"),localStorage.clear(),void(window.location="/login")):401!==e.response.status?(console.log("I am at 401"),Promise.reject(e)):void 0})),e}}]),e}().Instance();function C(){var e=JSON.parse(localStorage.getItem("syntoken"));return e?{Authorization:"Bearer "+e,Accept:"application/json","Content-Type":"application/json"}:{Accept:"application/json","Content-Type":"application/json"}}var O="/",S=a(45),j=Object(S.a)(),w=a(63),D=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getUser",value:function(e){return k.get("/api/user/"+e)}},{key:"getUsers",value:function(){return k.get("/api/user/")}},{key:"getRoles",value:function(){return k.get("/api/user/roles")}},{key:"createUser",value:function(e){var t={userName:e.userName,lastName:e.lastName,firstName:e.firstName,email:e.email,id:e.id,roles:e.roles},a={method:"POST",headers:C(),data:JSON.stringify(t),url:O+"api/user/"};return e.id&&(a.method="PUT"),k(a)}},{key:"deleteUser",value:function(e){return k.delete("/api/user/"+e)}},{key:"isLoggedIn",value:function(){return JSON.parse(localStorage.getItem("syntoken"))?(console.log("located token, returning true"),!0):(console.log("cannot locate token, returning false"),!1)}},{key:"login",value:function(){var e=Object(b.a)(v.a.mark((function e(t,a){var n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.post("/login",JSON.stringify({username:t,password:a}),{headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,console.log("got this response",n),(r=n.data)&&localStorage.setItem("syntoken",JSON.stringify(r)),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{key:"logout",value:function(){localStorage.removeItem("syntoken"),j.push("/#/login"),w.EventBus.publish("login-logout",{})}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),I=d.a.Sider,T=g.a.SubMenu,x=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(s)))).state={collapsed:!1},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(I,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},c.a.createElement("div",{className:"logo"},c.a.createElement("img",{src:"synlabs-logo.png"})),c.a.createElement(g.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["0"]},c.a.createElement(g.a.Item,{key:"0"},c.a.createElement(p.b,{to:"/"},c.a.createElement(m.a,{type:"home"}),c.a.createElement("span",{className:"nav-text"},"Home"))),c.a.createElement(T,{key:"sub1",title:c.a.createElement("span",null,c.a.createElement(m.a,{type:"box-plot"}),c.a.createElement("span",null,"ANPR"))},c.a.createElement(g.a.Item,{key:"1",className:"sidebar-nav-link"},c.a.createElement(p.b,{to:"/anpr"},c.a.createElement("span",{className:"nav-text"},"Events"))),c.a.createElement(g.a.Item,{key:"2",className:"sidebar-nav-link"},c.a.createElement(p.b,{to:"/anpr/masterdata"},c.a.createElement("span",{className:"nav-text"},"Repeated Events")))),c.a.createElement(T,{key:"sub2",title:c.a.createElement("span",null,c.a.createElement(m.a,{type:"box-plot"}),c.a.createElement("span",null,"Offends"))},c.a.createElement(g.a.Item,{key:"3",className:"sidebar-nav-link"},c.a.createElement(p.b,{to:"/incidents"},c.a.createElement("span",{className:"nav-text"},"Events"))),c.a.createElement(g.a.Item,{key:"4",className:"sidebar-nav-link"},c.a.createElement(p.b,{to:"/incidents/repeated"},c.a.createElement("span",{className:"nav-text"},"Repeated Events")))),c.a.createElement(g.a.Item,{key:"5",className:"sidebar-nav-link"},c.a.createElement(p.b,{to:"/incidents/hotlisted"},c.a.createElement(m.a,{type:"alert"}),c.a.createElement("span",{className:"nav-text"},"Hotlisted Vehicle Event"))),c.a.createElement(g.a.Item,{key:"6"},c.a.createElement(p.b,{to:"/feed"},c.a.createElement(m.a,{type:"video-camera"}),c.a.createElement("span",{className:"nav-text"},"Feed"))),c.a.createElement(g.a.Item,{key:"7"},c.a.createElement(p.b,{to:"/",onClick:function(){return D.logout()}},c.a.createElement(m.a,{type:"logout"}),c.a.createElement("span",{className:"nav-text"},"Logout")))))}}]),t}(o.Component),P=d.a.Header,z=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(P,{style:{background:"#fff",padding:10}},"\xa0")}}]),t}(o.Component),L=d.a.Footer,M=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(L,{style:{textAlign:"center"}},"SynergyLabs \xa9 2019")}}]),t}(o.Component),F=a(276),N=a(65),R=function(e){var t=e.component,a=Object(F.a)(e,["component"]);return c.a.createElement(N.b,Object.assign({},a,{render:function(e){return D.isLoggedIn()?c.a.createElement(t,e):c.a.createElement(N.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},V=a(34),A=a(4),H=a(115),B=a(526),Y=a(532),U=a(535),Z=a(145),W=a(56),q=a(16),J=a.n(q),X=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getTotalNoOfVehiclesBetweenTwoDates",value:function(e){return k.post("/api/dashboard/vehiclescount/datefilter",e)}},{key:"getTotalNoOfVehiclesBySelectedDate",value:function(e){return k.post("/api/dashboard/vehiclescount/date",e)}},{key:"getTotalNoOfVehiclesForLastMonths",value:function(e){return k.post("/api/dashboard/vehiclescount/month",e)}},{key:"getAtccVehicleCount",value:function(e,t,a){var n={fromDateString:J()(e).format("YYYY-MM-DD HH:mm:ss"),toDateString:J()(t).format('YYYY-MM-DD HH:mm:ss"'),xAxis:a};return k.post("/api/dashboard/atcc/vehicle/count",n)}},{key:"getIncidentVehicleCount",value:function(e,t,a){var n={fromDateString:J()(e).format("YYYY-MM-DD HH:mm:ss"),toDateString:J()(t).format("YYYY-MM-DD HH:mm:ss"),xAxis:a};return k.post("/api/dashboard/incident/vehicle/count",n)}},{key:"getColor",value:function(e){return["#e83e8c","#dc3545","#007bff","#6610f2","#fd7e14","#ffc107","#28a745","#20c997","#17a2b8","#6c757d","#343a40","#6f42c1"][e]||this.getRandomColor()}},{key:"getRandomColor",value:function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}},{key:"extractFromToDate",value:function(e,t){var a,n,r;switch(e){case"Today":n=(a=J()()).startOf("day").toDate(),r=a.endOf("day").toDate();break;case"Yesterday":n=(a=J()().subtract(1,"days")).startOf("day").toDate(),r=a.endOf("day").toDate();break;case"This week":n=(a=J()()).startOf("week").toDate(),r=a.endOf("week").toDate();break;case"This month":n=(a=J()()).startOf("month").toDate(),r=a.endOf("month").toDate();break;case"This quarter":n=(a=J()()).startOf("quarter").toDate(),r=a.endOf("quarter").toDate();break;case"This year":n=(a=J()()).startOf("year").toDate(),r=a.endOf("year").toDate();break;case"Last week":n=(a=J()().subtract(1,"weeks")).startOf("week").toDate(),r=a.endOf("week").toDate();break;case"Last month":n=(a=J()().subtract(1,"months")).startOf("month").toDate(),r=a.endOf("month").toDate();break;case"Last quarter":n=(a=J()().subtract(1,"quarters")).startOf("quarter").toDate(),r=a.endOf("quarter").toDate();break;case"Last year":n=(a=J()().subtract(1,"years")).startOf("year").toDate(),r=a.endOf("year").toDate();break;case"Second Last week":n=(a=J()().subtract(2,"weeks")).startOf("week").toDate(),r=a.endOf("week").toDate();break;case"Second Last month":n=(a=J()().subtract(2,"months")).startOf("month").toDate(),r=a.endOf("month").toDate();break;case"Second Last quarter":n=(a=J()().subtract(2,"quarters")).startOf("quarter").toDate(),r=a.endOf("quarter").toDate();break;case"Second Last year":n=(a=J()().subtract(2,"years")).startOf("year").toDate(),r=a.endOf("year").toDate();break;case"Custom":n=t[0].toDate(),r=t[1].toDate()}return{from_date:n,to_date:r}}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Q=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"ifExist",value:function(e,t,a){for(var n=0;n<e.length;n+=1)if(e[n][t]===a)return!0;return!1}},{key:"findIndex",value:function(e,t,a){if(!e)return-1;for(var n=0;n<e.length;n+=1)if(e[n][t]===a)return n;return-1}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),G=(a(2),a(195)),_=(a(429),a(430),H.a.Option,B.a.RangePicker),K=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).handleCancel=function(e){a.setState({isOpencustomDateRangeModal:""})},a.state={isOpencustomDateRangeModal:"",atcc:{filter:{selectedCustomDateRange:"Today",selectedXAxisOption:"Hourly",fromDate:{},toDate:{}},chartData:{labels:[],datasets:[]}},incident:{filter:{selectedCustomDateRange:"Today",selectedXAxisOption:"Hourly",fromDate:{},toDate:{}},chartData:{labels:[],datasets:[]}}},a.getIncidentVehicleCount=a.getIncidentVehicleCount.bind(Object(A.a)(a)),a.getAtccVehicleCount=a.getAtccVehicleCount.bind(Object(A.a)(a)),a.getBarChartOptions=a.getBarChartOptions.bind(Object(A.a)(a)),a.selectDateRange=a.selectDateRange.bind(Object(A.a)(a)),a.selectXAxisOption=a.selectXAxisOption.bind(Object(A.a)(a)),a.refresh=a.refresh.bind(Object(A.a)(a)),a.getDateRangeOptions=a.getDateRangeOptions.bind(Object(A.a)(a)),a.getXAxisOptions=a.getXAxisOptions.bind(Object(A.a)(a)),a.handleDateRangeChange=a.handleDateRangeChange.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"showCustomDateRangeModal",value:function(e){this.setState({isOpencustomDateRangeModal:e})}},{key:"selectDateRange",value:function(e,t,a){var n,r=this,i=this.state.isOpencustomDateRangeModal,l=this.state[e];l.filter.selectedCustomDateRange=t;var s=X.extractFromToDate(l.filter.selectedCustomDateRange,a);l.filter.fromDate=s.from_date,l.filter.toDate=s.to_date,"Custom"===t&&(i=""),this.setState((n={},Object(V.a)(n,e,l),Object(V.a)(n,"isOpencustomDateRangeModal",i),n),(function(){r.refresh()}))}},{key:"selectXAxisOption",value:function(e,t){var a=this,n=this.state[e];n.filter.selectedXAxisOption=t,this.setState(Object(V.a)({},e,n),(function(){a.refresh()}))}},{key:"refresh",value:function(){this.getAtccVehicleCount(this.state.atcc.filter.fromDate,this.state.atcc.filter.toDate,this.state.atcc.filter.selectedXAxisOption),this.getIncidentVehicleCount(this.state.incident.filter.fromDate,this.state.incident.filter.toDate,this.state.incident.filter.selectedXAxisOption)}},{key:"getAtccVehicleCount",value:function(e,t,a){var n=this,r=this.state.atcc;r.chartData={labels:[],datasets:[]},X.getAtccVehicleCount(e,t,a).then((function(e){var t=e.data;if(t&&t.length>0){var a=[],i=[];for(var l in t)a.includes(t[l].date)||a.push(t[l].date),i[t[l].vehicleType]||(i[t[l].vehicleType]={}),i[t[l].vehicleType][t[l].date]||(i[t[l].vehicleType][t[l].date]=t[l]);r.chartData.labels=a;var s=0;for(var o in i){var c={label:o,data:[],backgroundColor:X.getColor(s)};for(var u in a)i[o][a[u]]?c.data.push(i[o][a[u]].vehicleCount):c.data.push(0);r.chartData.datasets.push(c),s++}}n.setState({atcc:r})})).catch((function(e){console.log(e)}))}},{key:"getIncidentVehicleCount",value:function(e,t,a){var n=this,r=this.state.incident;r.chartData={labels:[],datasets:[]},X.getIncidentVehicleCount(e,t,a).then((function(e){var t=e.data.helmetMissingIncidents,i=e.data.reverseDirectionIncidents,l=[];for(var s in i)"Hourly"===a&&(i[s].date=parseInt(i[s].date)),l.includes(i[s].date)||l.push(i[s].date);for(var o in t)"Hourly"===a&&(t[o].date=parseInt(t[o].date)),l.includes(t[o].date)||l.push(t[o].date);"Hourly"===a&&l.sort((function(e,t){return e-t})),"Daily"===a&&l.sort((function(e,t){return new J.a(e).format("YYYY-MM-DD")-new J.a(t).format("YYYY-MM-DD")}));var c={label:"Without Helmet",data:[],backgroundColor:X.getColor(0)},u={label:"Reverse Direction",data:[],backgroundColor:X.getColor(2)},h=0,d=-1;for(var g in l)h=0,(d=Q.findIndex(t,"date",l[g]))>-1&&(h=t[d].vehicleCount),c.data.push(h),h=0,(d=Q.findIndex(i,"date",l[g]))>-1&&(h=i[d].vehicleCount),u.data.push(h);r.chartData.labels=l,r.chartData.datasets.push(c),r.chartData.datasets.push(u),n.setState({incident:r})})).catch((function(e){n.setState({incident:r}),console.log(e)}))}},{key:"handleDateRangeChange",value:function(e,t){var a=this;e[0].toDate(),e[1].toDate();this.setState((function(){a.refresh()})),console.log(e,t)}},{key:"getXAxisOptions",value:function(e){var t=this;return c.a.createElement(g.a,null,c.a.createElement(g.a.Item,{key:"1",onClick:function(){return t.selectXAxisOption(e,"Hourly")}},"Hourly"),c.a.createElement(g.a.Item,{key:"5",onClick:function(){return t.selectXAxisOption(e,"Daily")}},"Daily"))}},{key:"getDateRangeOptions",value:function(e){var t=this;return c.a.createElement(g.a,null,c.a.createElement(g.a.Item,{key:"1",onClick:function(){return t.selectDateRange(e,"Today")}},"Today"),c.a.createElement(g.a.Item,{key:"2",onClick:function(){return t.selectDateRange(e,"Yesterday")}},"Yesterday"),c.a.createElement(g.a.Item,{key:"3",onClick:function(){return t.selectDateRange(e,"This week")}},"This week"),c.a.createElement(g.a.Item,{key:"4",onClick:function(){return t.selectDateRange(e,"Last week")}},"Last week"),c.a.createElement(g.a.Item,{key:"5",onClick:function(){return t.selectDateRange(e,"This month")}},"This month"),c.a.createElement(g.a.Item,{key:"6",onClick:function(){return t.selectDateRange(e,"This year")}},"This year"),c.a.createElement(g.a.Item,{key:"7",onClick:function(){return t.selectDateRange(e,"Last year")}},"Last year"),c.a.createElement(g.a.Item,{onClick:function(){return t.showCustomDateRangeModal(e)}},"Custom"))}},{key:"getBarChartOptions",value:function(e){var t="Day";"Hourly"===this.state[e].filter.selectedXAxisOption&&(t="Hours(24-hour)");var a="Vehicles";return"incident"===e&&(a="Challans"),{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,legend:{position:"right"},scales:{xAxes:[{stacked:!0,ticks:{beginAtZero:!0},scaleLabel:{display:!0,labelString:t}}],yAxes:[{stacked:!0,ticks:{beginAtZero:!0},scaleLabel:{display:!0,labelString:a}}]}}}},{key:"render",value:function(){var e=this,t=this.state,a=t.atcc,n=t.incident,r=this.getBarChartOptions("atcc"),i=this.getBarChartOptions("incident");return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement(Y.a,{onCancel:this.handleCancel,title:"Custom Date Range",visible:!!this.state.isOpencustomDateRangeModal,footer:[]},c.a.createElement(_,{onChange:function(t){return e.selectDateRange(e.state.isOpencustomDateRangeModal,"Custom",t)}}))),c.a.createElement("div",null,c.a.createElement(U.a,{title:c.a.createElement("div",null,"ATCC \xa0",c.a.createElement(Z.a,{overlay:function(){return e.getDateRangeOptions("atcc")}},c.a.createElement(W.a,null,a.filter.selectedCustomDateRange?a.filter.selectedCustomDateRange:"Select",c.a.createElement(m.a,{type:"down"}))),"\xa0",c.a.createElement(Z.a,{overlay:function(){return e.getXAxisOptions("atcc")}},c.a.createElement(W.a,null,a.filter.selectedXAxisOption?a.filter.selectedXAxisOption:"Select"," ",c.a.createElement(m.a,{type:"down"}))))},c.a.createElement(G.a,{data:a.chartData,options:r})),c.a.createElement("br",null),c.a.createElement(U.a,{title:c.a.createElement("div",null,"Incidents \xa0",c.a.createElement(Z.a,{overlay:function(){return e.getDateRangeOptions("incident")}},c.a.createElement(W.a,null,n.filter.selectedCustomDateRange?n.filter.selectedCustomDateRange:"Select",c.a.createElement(m.a,{type:"down"}))),"\xa0",c.a.createElement(Z.a,{overlay:function(){return e.getXAxisOptions("incident")}},c.a.createElement(W.a,null,n.filter.selectedXAxisOption?n.filter.selectedXAxisOption:"Select",c.a.createElement(m.a,{type:"down"}))))},c.a.createElement(G.a,{data:n.chartData,options:i}))))}}]),t}(o.Component),$=a(528),ee=a(527),te=a(100),ae=a(58),ne=a(275),re=a(533),ie=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getFeeds",value:function(){return k.get("/api/feeds")}},{key:"getFeed",value:function(e){return k.get("/api/feed/"+e.ID)}},{key:"addFeed",value:function(e){return k.post("/api/feed/",e)}},{key:"removeFeed",value:function(e){return k.delete("/api/feed/"+e.ID)}},{key:"startFeed",value:function(e){return k.get("/api/feed/"+e.ID+"/start")}},{key:"stopFeed",value:function(e){return k.get("/api/feed/"+e.ID+"/stop")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),le=$.a.Text,se=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,feeds:{}},w.EventBus.subscribe("feed-refresh",(function(e){return a.refresh()})),a.removeFeed=a.removeFeed.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;ie.getFeeds().then((function(t){e.setState({feeds:t.data,loading:!1})}))}},{key:"removeFeed",value:function(e){var t=this;ie.removeFeed(e).then((function(){t.refresh()}))}},{key:"startFeed",value:function(e){var t=this;ie.startFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"stopFeed",value:function(e){var t=this;ie.stopFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"render",value:function(){var e=this,t=this.state.feeds;!this.state.loading&&this.state.feeds&&0!==this.state.feeds.length||(t=[]);var a=ee.a.create({name:"feed_form"})(oe);return c.a.createElement(te.a,{gutter:16},t.map((function(t,a){return c.a.createElement(ae.a,{span:8,key:a},c.a.createElement(U.a,{title:c.a.createElement(ne.a,{color:"#f50"},t.site,"/",t.location,"/",t.name),cover:c.a.createElement("img",{alt:"feedview",src:"/api/feed/"+t.ID+"/view"}),bordered:!0,actions:[c.a.createElement(W.a,{onClick:function(){e.startFeed(t)}},"Start"),c.a.createElement(W.a,{onClick:function(){e.stopFeed(t)}},"Stop"),c.a.createElement(W.a,{onClick:function(){e.removeFeed(t)}},"Delete")]}))})),c.a.createElement(ae.a,{span:8,key:-1},c.a.createElement(U.a,{bordered:!0},c.a.createElement(a,null))))}}]),t}(o.Component);var oe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t,a=this.props.form,n={};n.url=a.getFieldValue("url"),n.site=a.getFieldValue("site"),n.location=a.getFieldValue("location"),n.name=a.getFieldValue("name"),n.url||(t="Missing url"),n.site||(t="Missing site"),n.location||(t="Missing location"),n.name||(t="Missing name"),t?this.setState({validationError:t}):(console.log("saving feed",n),this.setState({submitted:!0,loading:!0}),ie.addFeed(n).then((function(e){w.EventBus.publish("feed-refresh",{})})))}},{key:"render",value:function(){var e,t=this.props.form,a=t.getFieldDecorator,n=t.getFieldsError,r=this.state.validationError;return c.a.createElement(ee.a,{onSubmit:this.handleSubmit},c.a.createElement(ee.a.Item,null,a("url",{rules:[{required:!0,message:"enter feed url!"}]})(c.a.createElement(re.a,{addonBefore:"Feed\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"rtsp://"}))),c.a.createElement(ee.a.Item,null,a("site",{rules:[{required:!0,message:"enter site!"}]})(c.a.createElement(re.a,{addonBefore:"Site\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"Site (e.g. gurgaon)"}))),c.a.createElement(ee.a.Item,null,a("location",{rules:[{required:!0,message:"enter location!"}]})(c.a.createElement(re.a,{addonBefore:"Location",placeholder:"Location (e.g. 9th floor)"}))),c.a.createElement(ee.a.Item,null,a("name",{rules:[{required:!0,message:"enter name!"}]})(c.a.createElement(re.a,{addonBefore:"Name\xa0\xa0\xa0\xa0",placeholder:"Name (e.g. front gate )"}))),c.a.createElement(W.a,{htmlType:"submit",type:"primary",disabled:(e=n(),Object.keys(e).some((function(t){return e[t]})))},"Add"),r&&c.a.createElement(le,{type:"danger"},r))}}]),t}(o.Component),ce=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getDevice",value:function(){return k.get("/api/device")}},{key:"getDeviceConfig",value:function(){return k.get("/api/device/config")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),ue=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,device:{}},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;ce.getDevice().then((function(t){e.setState({device:t.data,loading:!1})}),(function(e){console.log("error")}))}},{key:"render",value:function(){var e=this.state.loading,t=this.state.device;return e?c.a.createElement("div",null,"Loading.."):c.a.createElement("div",null,c.a.createElement(U.a,{title:"Device details",style:{width:300},extra:c.a.createElement(p.b,{to:"/device/conf"},c.a.createElement(m.a,{type:"setting"}))},c.a.createElement("p",null,"ID: ",t.fingerprint),c.a.createElement("p",null,"Name: ",t.name),c.a.createElement("p",null,"Model: ",t.model),c.a.createElement("p",null,"License: ",t.license),c.a.createElement("p",null,"Status: ",t.status),c.a.createElement("p",null,"RegisteredTo: ",t.registeredTo)))}}]),t}(o.Component),he=a(525),de=a(534),ge=a(524),me=(a(495),he.a.Column),pe=$.a.Text,fe=Y.a.confirm,ve=(H.a.Option,W.a.Group,function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).showModal=function(){a.setState({visible:!0})},a.state={loading:!0,users:[],showUserDetails:!1,mode:"Add",user:{userName:"",lastName:"",firstName:"",email:"",password:"",roles:[],id:""},roles:[],visible:!1},a.addUser=a.addUser.bind(Object(A.a)(a)),a.refresh=a.refresh.bind(Object(A.a)(a)),a.refreshUsers=a.refreshUsers.bind(Object(A.a)(a)),a.close=a.close.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;D.getUsers().then((function(t){e.setState({users:t.data,loading:!1,showUserDetails:!1})}),(function(e){de.a.error(e.response.data.message)})),D.getRoles().then((function(t){e.setState({roles:t.data})}),(function(e){de.a.error(e.response.data.message)}))}},{key:"refreshUsers",value:function(){this.refresh()}},{key:"addUser",value:function(){this.setState({mode:"Add",showUserDetails:!0,user:{userName:"",lastName:"",firstName:"",email:"",password:""}})}},{key:"showUser",value:function(e){var t=this;this.setState({showUserDetails:!0,mode:"Edit"}),D.getUser(e).then((function(e){t.setState({user:e.data})}),(function(e){de.a.error(e.response.data.message)}))}},{key:"close",value:function(){this.setState({showUserDetails:!1})}},{key:"showDeleteConfirm",value:function(e,t){fe({title:"Are you sure you want to make user inactive?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){console.log("OK"),D.deleteUser(e).then((function(e){de.a.success("User Deactivated!"),t()}),(function(e){de.a.error(e.response.data.message)}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t=ee.a.create({name:"user_form"})(be),a=this.state.showUserDetails;this.state.mode,this.state.user;return c.a.createElement("div",null,c.a.createElement(te.a,{gutter:2},c.a.createElement(ae.a,{span:2},c.a.createElement(W.a,{type:"primary",onClick:this.addUser},"+ ADD"))),c.a.createElement("br",null),c.a.createElement(te.a,{gutter:24},c.a.createElement(ae.a,{span:12},c.a.createElement(U.a,{className:"limitable",bodyStyle:{padding:"0px",width:"100%"}},c.a.createElement(he.a,{dataSource:this.state.users,pagination:!1,scroll:{x:!0}},c.a.createElement(me,{title:"Username",dataIndex:"userName",key:"userName",render:function(e,t){return c.a.createElement("span",null,c.a.createElement("a",{href:"user/"+t.ID},e))}}),c.a.createElement(me,{title:"Email",dataIndex:"email",key:"email"}),c.a.createElement(me,{title:"Token",dataIndex:"token",key:"token"}),c.a.createElement(me,{title:"Action",key:"action",render:function(t,a){return c.a.createElement("span",null,c.a.createElement("a",{onClick:e.showUser.bind(e,a.id)},"Edit"),c.a.createElement(ge.a,{type:"vertical"}),c.a.createElement("a",{onClick:e.showDeleteConfirm.bind(e,a.id,e.refresh)},"Delete"))}})))),a?c.a.createElement(ae.a,{span:12},c.a.createElement(t,{user:this.state.user,roles:this.state.roles,refresh:this.refreshUsers,close:this.close,mode:this.state.mode})):null))}}]),t}(o.Component)),be=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={user:{},loading:!1},a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a.close=a.close.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"close",value:function(){this.props.close()}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a,n=this.props.form,r={};r.firstName=n.getFieldValue("firstname"),r.userName=n.getFieldValue("username"),r.lastName=n.getFieldValue("lastname"),r.email=n.getFieldValue("email"),r.password=n.getFieldValue("password"),r.roles=n.getFieldValue("role"),r.id=this.props.user.id,r.firstName||(a="Missing firstname"),r.userName||(a="Missing username"),r.lastName||(a="Missing lastname"),r.email||(a="Missing email"),0==r.roles.length&&(a="Missing role"),a?this.setState({validationError:a}):(this.setState({loading:!0}),console.log("saving user",r),D.createUser(r).then((function(e){r.id?de.a.success("User updated"):de.a.success("User created"),t.setState({loading:!1}),t.props.refresh()})).catch((function(e){console.log(e),t.setState({loading:!1})})))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.validationError;return c.a.createElement(U.a,{title:"Add"==this.props.mode?"Add User":"Edit User"},c.a.createElement(ee.a,{onSubmit:this.handleSubmit,className:"user-form"},c.a.createElement(ee.a.Item,{label:"Username",className:"formitem"},e("username",{initialValue:this.props.user.userName,rules:[{required:!0,message:"Please input your username!"}]})(c.a.createElement(re.a,{type:"text",placeholder:"Username"}))),c.a.createElement(ee.a.Item,{label:"Firstname",className:"formitem"},e("firstname",{initialValue:this.props.user.firstName,rules:[{required:!0,message:"Please input your Firstname!"}]})(c.a.createElement(re.a,{type:"text",placeholder:"Firstname"}))),c.a.createElement(ee.a.Item,{label:"Lastname",className:"formitem"},e("lastname",{initialValue:this.props.user.lastName,rules:[{required:!0,message:"Please input your lastname!"}]})(c.a.createElement(re.a,{type:"text",placeholder:"Lastname"}))),c.a.createElement(ee.a.Item,{label:"Email",className:"formitem"},e("email",{initialValue:this.props.user.email,rules:[{required:!0,message:"Please input your email!"}]})(c.a.createElement(re.a,{type:"email",placeholder:"email"}))),c.a.createElement(ee.a.Item,{label:"Role",className:"formitem"},e("role",{initialValue:this.props.user.roles,rules:[{required:!0,message:"Please select role!"}]})(c.a.createElement(H.a,{mode:"multiple",placeholder:"Select a role"},this.props.roles.map((function(e){return c.a.createElement("option",{key:e.id,value:e.name},e.name)}))))),c.a.createElement("br",null),c.a.createElement("div",{align:"right"},c.a.createElement(W.a,{type:"primary",htmlType:"submit",className:"user-form-button",size:"small",loading:this.state.loading},"Save"),c.a.createElement("span",null,"\xa0\xa0"),c.a.createElement(W.a,{type:"secondary",className:"user-form-button",size:"small",onClick:this.close},"Close")),t&&c.a.createElement(pe,{type:"danger"},t)))}}]),t}(o.Component),ye=a(199),Ee=ye.a.TabPane,ke=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,deviceconfig:{}},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;ce.getDeviceConfig().then((function(t){e.setState({deviceconfig:t.data,loading:!1})}))}},{key:"onTabChange",value:function(e){console.log("tab changed",e)}},{key:"render",value:function(){return c.a.createElement(ye.a,{defaultActiveKey:"1",onChange:this.onTabChange},c.a.createElement(Ee,{tab:"Feed",key:"common"},"Feed details"),c.a.createElement(Ee,{tab:"Basic Intrusion",key:"bi"},"Basic Intrusion"),c.a.createElement(Ee,{tab:"Advanced Intrusion",key:"ai"},"Advanced Intrusion"))}}]),t}(o.Component),Ce=$.a.Text,Oe=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){D.isLoggedIn()&&j.push("/#/")}},{key:"render",value:function(){var e=ee.a.create({name:"login_form"})(Se);return c.a.createElement(e,null)}}]),t}(o.Component),Se=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.form,n=a.getFieldValue("username"),r=a.getFieldValue("password");if(this.setState({submitted:!0}),n&&r){this.setState({loading:!0});D.login(n,r).then((function(e){var t=(j.state||{from:{pathname:"/"}}).from;j.push(t),window.location.reload()})).catch((function(e){t.setState({loginError:"Something went wrong, please try again",loading:!1})}))}}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.loginError;return c.a.createElement(te.a,null,c.a.createElement(ae.a,{xl:{span:8},lg:{span:6},md:{span:4},sm:{span:2},xs:{span:2}}),c.a.createElement(ae.a,{xl:{span:8},lg:{span:12},md:{span:12},sm:{span:24},xs:{span:24}},c.a.createElement(U.a,{title:c.a.createElement("img",{style:{},src:"synlabs-logo-full.png"})},c.a.createElement(ee.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement(ee.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(c.a.createElement(re.a,{prefix:c.a.createElement(m.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),c.a.createElement(ee.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(c.a.createElement(re.a,{prefix:c.a.createElement(m.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),c.a.createElement(ee.a.Item,null,c.a.createElement(W.a,{type:"primary",htmlType:"submit",block:!0,className:"login-form-button"},"Log in"))),t&&c.a.createElement(Ce,{type:"danger"},t))))}}]),t}(o.Component),je=Object(N.g)(Oe),we=a(531),De=a(101),Ie=a(274),Te=a(273),xe=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getIncidents",value:function(e){return k.post("/api/traffic/incident/",e)}},{key:"archiveIncident",value:function(e){return k.delete("/api/traffic/incident/"+e.id)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Pe=a(197),ze=a.n(Pe),Le=a(27),Me=a.n(Le);function Fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ne=he.a.Column,Re=(he.a.ColumnGroup,we.a.Panel),Ve=W.a.Group,Ae=Y.a.confirm,He=(o.Component,function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getTrigger",value:function(){return k.get("/api/trigger/")}},{key:"getTriggers",value:function(){return k.get("/api/triggers")}},{key:"createTrigger",value:function(e){return k.post("/api/trigger/",e)}},{key:"saveTrigger",value:function(e){return k.put("/api/trigger/"+e.ID,e)}},{key:"deleteTrigger",value:function(e){return k.delete("/api/trigger/"+e.ID)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance()),Be=a(529),Ye=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a.onChange0=a.onChange0.bind(Object(A.a)(a)),a.onChange1=a.onChange1.bind(Object(A.a)(a)),a.onChange2=a.onChange2.bind(Object(A.a)(a)),a.onChange3=a.onChange3.bind(Object(A.a)(a)),a.onChange4=a.onChange4.bind(Object(A.a)(a)),a.onChange5=a.onChange5.bind(Object(A.a)(a)),a.onChange6=a.onChange6.bind(Object(A.a)(a)),a.onChangeValue=a.onChangeValue.bind(Object(A.a)(a)),a.saveTrigger=a.saveTrigger.bind(Object(A.a)(a)),a.deleteTrigger=a.deleteTrigger.bind(Object(A.a)(a)),a.setName=a.setName.bind(Object(A.a)(a)),a.state={trigger:a.props.trigger,changed:!1},a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"onChange0",value:function(e){this.onChangeValue(0,e)}},{key:"onChange1",value:function(e){this.onChangeValue(1,e)}},{key:"onChange2",value:function(e){this.onChangeValue(2,e)}},{key:"onChange3",value:function(e){this.onChangeValue(3,e)}},{key:"onChange4",value:function(e){this.onChangeValue(4,e)}},{key:"onChange5",value:function(e){this.onChangeValue(5,e)}},{key:"onChange6",value:function(e){this.onChangeValue(6,e)}},{key:"onChangeValue",value:function(e,t){var a=this.state.trigger;a.TriggerDays[e].Start=t[0],a.TriggerDays[e].End=t[1],this.setState({trigger:a,changed:!0})}},{key:"saveTrigger",value:function(){this.state.trigger.new?He.createTrigger(this.state.trigger):He.saveTrigger(this.state.trigger)}},{key:"NewTrigger",value:function(){for(var e={name:"New",TriggerDays:[],new:!0},t=0;t<7;t++)e.TriggerDays.push({Start:0,End:24,Day:t});this.setState({trigger:e,changed:!0})}},{key:"setName",value:function(e,t){var a=this.state.trigger;a.name=e.target.value,this.setState({trigger:a,changed:!0})}},{key:"deleteTrigger",value:function(){He.deleteTrigger(this.state.trigger)}},{key:"ChangeTrigger",value:function(e){this.setState({trigger:e,changed:!1})}},{key:"render",value:function(){var e=this.state.trigger,t=this.state.changed;if(!e)return c.a.createElement("div",null,"Waiting..");for(var a={},n=12;n<=24;n++){a[n-12]=n+":00"}for(var r=0;r<=12;r++){a[r+12]=(r<10?"0":"")+r+":00"}e.TriggerDays.map((function(e,t){var a=e.Start,n=e.End;a>n&&(e.Start=a-12,e.End=n+12)}));var i=e.TriggerDays;return c.a.createElement("div",null,e.new?c.a.createElement(re.a,{placeholder:"Name",onChange:this.setName}):c.a.createElement("span",null,e.ID," - ",e.name),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[0].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[0].Start,i[0].End],onChange:this.onChange0})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[1].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[1].Start,i[1].End],onChange:this.onChange1})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[2].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[2].Start,i[2].End],onChange:this.onChange2})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[3].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[3].Start,i[3].End],onChange:this.onChange3})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[4].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[4].Start,i[4].End],onChange:this.onChange4})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[5].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[5].Start,i[5].End],onChange:this.onChange5})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[6].Day]),c.a.createElement(Be.a,{min:0,max:24,range:!0,marks:a,value:[i[6].Start,i[6].End],onChange:this.onChange6})),c.a.createElement(W.a,{type:"primary",disabled:!t,onClick:this.saveTrigger},"Save"),c.a.createElement(W.a,{type:"link",disabled:t,onClick:this.deleteTrigger},"Delete"))}}]),t}(o.Component),Ue=H.a.Option,Ze=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,triggers:[]},a.tsRef=c.a.createRef(),a.handleChange=a.handleChange.bind(Object(A.a)(a)),a.newTrigger=a.newTrigger.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;He.getTriggers().then((function(t){e.setState({triggers:t.data,selected:t.data[0].ID,selectedt:t.data[0],loading:!1})}))}},{key:"newTrigger",value:function(){this.tsRef.current.NewTrigger()}},{key:"handleChange",value:function(e){console.log("changing to ...",e);for(var t=0;t<this.state.triggers.length;t++)if(console.log("checking:",this.state.triggers[t].ID),e==this.state.triggers[t].ID)return console.log("selected:",e),this.tsRef.current.ChangeTrigger(this.state.triggers[t]),void this.setState({selected:e,selectedt:this.state.triggers[t]});console.log("cant select:(")}},{key:"render",value:function(){var e=this.state.selected,t=this.state.selectedt,a=this.state.triggers;this.state.loading&&(a=[]);var n="";t&&(n=t.Name),console.log("SN",n,e,t);var r=c.a.createElement("div",null,c.a.createElement(H.a,{style:{width:120},onChange:this.handleChange},a.map((function(e,t){return c.a.createElement(Ue,{key:e.ID},e.name)}))),"\xa0",c.a.createElement(W.a,{type:"primary",onClick:this.newTrigger},"New"));return t?c.a.createElement("div",null,r,c.a.createElement(Ye,{trigger:t,ref:this.tsRef})):r}}]),t}(o.Component),We=W.a.Group,qe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,layout:"list",filter:{page:1,pageSize:10}},a.onFromDateChange=a.onFromDateChange.bind(Object(A.a)(a)),a.onFromTimeChange=a.onFromTimeChange.bind(Object(A.a)(a)),a.onToDateChange=a.onToDateChange.bind(Object(A.a)(a)),a.onToTimeChange=a.onToTimeChange.bind(Object(A.a)(a)),a.onPageChange=a.onPageChange.bind(Object(A.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(A.a)(a)),a.refresh=a.refresh.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"refresh",value:function(){this.props.handleRefresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"changeLayout",value:function(e){this.setState({layout:e}),this.props.handleLayoutChange(e)}},{key:"onFromDateChange",value:function(e){var t=this.state.filter;t.fromDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onFromTimeChange",value:function(e){var t=this.state.filter;t.fromTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onToDateChange",value:function(e){var t=this.state.filter;t.toDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onToTimeChange",value:function(e){var t=this.state.filter;t.toTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"render",value:function(){var e=this,t=this.state.layout;return c.a.createElement("div",null,c.a.createElement("span",null,"From: "),c.a.createElement(B.a,{onChange:this.onFromDateChange}),"\xa0\xa0",c.a.createElement(Ie.a,{minuteStep:15,secondStep:60,onChange:this.onFromTimeChange}),"\xa0\xa0",c.a.createElement("span",null,"To: "),c.a.createElement(B.a,{onChange:this.onToDateChange}),"\xa0\xa0",c.a.createElement(Ie.a,{minuteStep:15,secondStep:60,onChange:this.onToTimeChange}),"\xa0\xa0",c.a.createElement(We,null,c.a.createElement(W.a,{type:"list"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("list")}}),c.a.createElement(W.a,{type:"table"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("table")}})),"\xa0\xa0",c.a.createElement(W.a,{onClick:function(){e.refresh()}},c.a.createElement(m.a,{type:"reload"}),"Reload"))}}]),t}(o.Component),Je=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getEvents",value:function(e){return k.post("/api/anpr/events",e)}},{key:"getIncidents",value:function(e){return k.post("/api/anpr/incidents",e)}},{key:"getIncidentsHotlisted",value:function(e){return k.post("/api/anpr/incidents/hotListed",e)}},{key:"archiveEvent",value:function(e){return k.delete("/api/anpr/"+e.id)}},{key:"archiveAllEvent",value:function(e){return k.put("/api/anpr/events/archive/"+e)}},{key:"updateEvent",value:function(e){return k.put("/api/anpr/event",e)}},{key:"getEventFile",value:function(e){return k.get("/public/anpr/anprText/"+e+"/image.jpg")}},{key:"getHelmetMissingIncidentsRepeated",value:function(e){return k.post("/api/incident/repeated/helmet-missing",e)}},{key:"getReverseDirectionIncidentsRepeated",value:function(e){return k.post("/api/incident/repeated/reverse",e)}},{key:"getBriefIncidentsRepeated",value:function(e){return k.post("/api/incident/timeline",e)}},{key:"getIncidentTimeline",value:function(e){return k.post("/api/anpr/events/list/bylpr",e)}},{key:"getIncidentsList",value:function(e){return k.post("/api/anpr/events/list/lpr/count",e)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Xe=a(72);function Qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Ge=$.a.Paragraph,_e=$.a.Text,Ke=he.a.Column,$e=we.a.Panel,et=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).handleOnClick=function(e){console.log(e),a.setState({visible:!1})},a.state={visible:!0,loading:!0,layout:"list",events:{},filter:{page:1,pageSize:12},workingEvent:{},workingEventLoading:!1,magnifyEvent:{magnifyEventId:"",zoomFactor:2,minZoomFactor:1,maxZoomFactor:5}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.handleFilterChange=a.handleFilterChange.bind(Object(A.a)(a)),a.handleLayoutChange=a.handleLayoutChange.bind(Object(A.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(A.a)(a)),a.onPageChange=a.onPageChange.bind(Object(A.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a.editEvent=a.editEvent.bind(Object(A.a)(a)),a.updateEvent=a.updateEvent.bind(Object(A.a)(a)),a.magnifyEvent=a.magnifyEvent.bind(Object(A.a)(a)),a.updateZoomFactor=a.updateZoomFactor.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;Je.getEvents(this.state.filter).then((function(t){e.setState({anprresponse:t.data,loading:!1})}))}},{key:"refreshNow",value:function(e){var t=this;Je.getEvents(this.state.filter).then((function(e){t.setState({anprresponse:e.data,loading:!1})}))}},{key:"archiveEvent",value:function(e){var t=this;Je.archiveEvent(e).then((function(e){t.refresh()}))}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,console.log(t),this.setState({filter:t})}},{key:"handleFilterChange",value:function(e){this.setState({filter:e})}},{key:"handleLayoutChange",value:function(e){this.setState({layout:e})}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"editEvent",value:function(e){this.setState({workingEvent:e})}},{key:"magnifyEvent",value:function(e){var t=this.state.magnifyEvent;t.magnifyEventId=e.id,this.setState({magnifyEvent:t})}},{key:"updateZoomFactor",value:function(e){var t=this.state.magnifyEvent;t.zoomFactor=e,this.setState({magnifyEvent:t})}},{key:"updateEvent",value:function(e){var t=this,a=this.state,n=a.workingEvent;a.workingEventLoading;n.anprText=e,this.setState({workingEvent:n,workingEventLoading:!0}),Je.updateEvent(n).then((function(a){var n=t.state,r=n.workingEvent;n.workingEventLoading;r.anprText=e,t.setState({workingEventLoading:!1})})).catch((function(e){alert("error in saving");t.state.workingEventLoading;t.setState({workingEventLoading:!1})}))}},{key:"render",value:function(){var e=this.state.layout,t=this.state.filter.lpr;return c.a.createElement("div",null,c.a.createElement("h3",null,"ANPR"),c.a.createElement(we.a,{bordered:!1,defaultActiveKey:["1"]},c.a.createElement($e,{header:"Filter",key:"1"},"LPR: ",c.a.createElement(re.a,{value:t,style:{width:"200px"},onChange:this.onLprInputChange})," ",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(qe,{handleRefresh:this.refresh,filter:this.state.filter,layout:e,handleFilterChange:this.handleFilterChange,handleLayoutChange:this.handleLayoutChange}))),c.a.createElement("div",null,"table"===e?this.renderTable():this.renderGrid()))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.anprresponse||0===this.state.anprresponse.totalPage)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.workingEventLoading,n=this.state.workingEvent,r=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,i=this.state.magnifyEvent,l=i.magnifyEventId,s=i.zoomFactor,o=i.minZoomFactor,u=i.maxZoomFactor,h=((u-o)/2).toFixed(5),d=s>=h?"":"rgba(0, 0, 0, .45)",p=s>=h?"rgba(0, 0, 0, .45)":"",f={1:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:d},type:"zoom-out"}))},2:{label:c.a.createElement("span",null,"2")},3:{label:c.a.createElement("span",null,"3")},4:{label:c.a.createElement("span",null,"4")},5:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:p},type:"zoom-in"}))}};return c.a.createElement("div",{style:{background:"#ECECEC",padding:"5px"}},c.a.createElement(te.a,null,t.map((function(t,r){return c.a.createElement(ae.a,{xl:{span:8},lg:{span:12},md:{span:12},sm:{span:24},xs:{span:24},key:r},c.a.createElement(U.a,{style:{margin:"5px"},title:c.a.createElement("div",null,t.direction&&"rev"===t.direction?c.a.createElement(ne.a,{color:"#f50"},"Reverse"):null,t.helmet?c.a.createElement(ne.a,{color:"#f50"},"Without helmet"):null),extra:c.a.createElement(Z.a,{overlay:c.a.createElement(g.a,null,c.a.createElement(g.a.Item,{key:"0",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom image"),c.a.createElement(g.a.Item,{key:"1"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/vehicle/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Full image")),c.a.createElement(g.a.Item,{key:"2"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Cropped image")),c.a.createElement(g.a.Item,{key:"3"},c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(t)}},c.a.createElement(m.a,{type:"delete"})," ","Delete")))},c.a.createElement(W.a,null,"More ",c.a.createElement(m.a,{type:"down"}))),bordered:!0,cover:l===t.id?c.a.createElement(Xe.a,{src:"/public/anpr/vehicle/"+t.id+"/image.jpg",zoomFactor:s}):c.a.createElement("img",{alt:"event",src:"/public/anpr/vehicle/"+t.id+"/image.jpg"})},c.a.createElement("div",null,l===t.id?c.a.createElement(Be.a,{marks:f,min:o,max:u,onChange:e.updateZoomFactor,value:"number"===typeof s?s:0}):c.a.createElement("div",{style:{height:"54px",textAlign:"center"}},c.a.createElement(W.a,{size:"small",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom Image"))),c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+t.id+"/image.jpg"})),c.a.createElement("div",{style:{marginTop:"5px",textAlign:"center"},onClick:function(){return e.editEvent(t)}},c.a.createElement(Ge,{strong:!0,editable:{onChange:e.updateEvent},copyable:!0},t.anprText),c.a.createElement(_e,{type:"secondary"},a&&n.id===t.id?"saving...":""),c.a.createElement("div",null,c.a.createElement(_e,{code:!0},c.a.createElement(m.a,{type:"schedule"})," ",c.a.createElement(Me.a,{format:"lll"},t.eventDate)," ","|"," ",c.a.createElement(Me.a,{format:"LTS"},t.eventDate))),c.a.createElement("div",null,c.a.createElement(_e,{code:!0},c.a.createElement(m.a,{type:"environment"})," ",t.location)))))}))),c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(Te.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:r,current:this.state.filter.page,pageSize:this.state.filter.pageSize})))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.events||0===this.state.events.Total)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qe(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qe(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(Ke,{title:"Location",dataIndex:"location",key:"location",render:function(e){return e}}),c.a.createElement(Ke,{title:"Date",dataIndex:"eventDate",key:"eventDate",render:function(e){return c.a.createElement(Me.a,{format:"L"},e)}}),c.a.createElement(Ke,{title:"Time",dataIndex:"eventDate",key:"eventTime",render:function(e){return c.a.createElement(Me.a,{format:"LTS"},e)}}),c.a.createElement(Ke,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(e){return e}}),c.a.createElement(Ke,{title:"LP Image",dataIndex:"id",key:"anprimage",render:function(e){return c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+e+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+e+"/image.jpg"}))}}),c.a.createElement(Ke,{title:"direction",dataIndex:"direction",key:"direction",render:function(e){return e}}),c.a.createElement(Ke,{title:"Helmet?",dataIndex:"helmet",key:"helmet",render:function(e){return e?c.a.createElement("span",null,"No"):c.a.createElement("span",null,"N/A")}}),c.a.createElement(Ke,{title:"Action",key:"action",render:function(t,a){return c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(a)}},c.a.createElement(m.a,{type:"warning"})," ","Delete")}}))}}]),t}(o.Component);function tt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var at=he.a.Column,nt=we.a.Panel,rt=$.a.Paragraph,it=$.a.Text,lt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0,layout:"list",events:{},filter:{page:1,pageSize:24},workingEvent:{},workingEventLoading:!1,magnifyEvent:{magnifyEventId:"",zoomFactor:2,minZoomFactor:1,maxZoomFactor:5}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.handleFilterChange=a.handleFilterChange.bind(Object(A.a)(a)),a.handleLayoutChange=a.handleLayoutChange.bind(Object(A.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(A.a)(a)),a.onPageChange=a.onPageChange.bind(Object(A.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a.editEvent=a.editEvent.bind(Object(A.a)(a)),a.updateEvent=a.updateEvent.bind(Object(A.a)(a)),a.magnifyEvent=a.magnifyEvent.bind(Object(A.a)(a)),a.updateZoomFactor=a.updateZoomFactor.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;Je.getIncidents(this.state.filter).then((function(t){e.setState({anprresponse:t.data,loading:!1})}))}},{key:"refreshNow",value:function(e){var t=this;Je.getIncidents(this.state.filter).then((function(e){t.setState({anprresponse:e.data,loading:!1})}))}},{key:"archiveEvent",value:function(e){var t=this;Je.archiveEvent(e).then((function(e){t.refresh()}))}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,console.log(t),this.setState({filter:t})}},{key:"handleFilterChange",value:function(e){this.setState({filter:e})}},{key:"handleLayoutChange",value:function(e){this.setState({layout:e})}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"editEvent",value:function(e){this.setState({workingEvent:e})}},{key:"magnifyEvent",value:function(e){var t=this.state.magnifyEvent;t.magnifyEventId=e.id,this.setState({magnifyEvent:t})}},{key:"updateZoomFactor",value:function(e){var t=this.state.magnifyEvent;t.zoomFactor=e,this.setState({magnifyEvent:t})}},{key:"updateEvent",value:function(e){var t=this,a=this.state,n=a.workingEvent;a.workingEventLoading;n.anprText=e,this.setState({workingEvent:n,workingEventLoading:!0}),Je.updateEvent(n).then((function(a){var n=t.state,r=n.workingEvent;n.workingEventLoading;r.anprText=e,t.setState({workingEventLoading:!1})})).catch((function(e){alert("error in saving");t.state.workingEventLoading;t.setState({workingEventLoading:!1})}))}},{key:"render",value:function(){var e=this.state.layout,t=this.state.filter.lpr;return c.a.createElement("div",null,c.a.createElement("h3",null,"Incidents"),c.a.createElement(we.a,{bordered:!1,defaultActiveKey:["1"]},c.a.createElement(nt,{header:"Filter",key:"1"},"LPR: ",c.a.createElement(re.a,{value:t,style:{width:"200px"},onChange:this.onLprInputChange})," ",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(qe,{handleRefresh:this.refresh,filter:this.state.filter,layout:e,handleFilterChange:this.handleFilterChange,handleLayoutChange:this.handleLayoutChange})),c.a.createElement("div",null,"table"===e?this.renderTable():this.renderGrid())))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.anprresponse||0===this.state.anprresponse.totalPage)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.workingEventLoading,n=this.state.workingEvent,r=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,i=this.state.magnifyEvent,l=i.magnifyEventId,s=i.zoomFactor,o=i.minZoomFactor,u=i.maxZoomFactor,h=((u-o)/2).toFixed(5),d=s>=h?"":"rgba(0, 0, 0, .45)",p=s>=h?"rgba(0, 0, 0, .45)":"",f={1:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:d},type:"zoom-out"}))},2:{label:c.a.createElement("span",null,"2")},3:{label:c.a.createElement("span",null,"3")},4:{label:c.a.createElement("span",null,"4")},5:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:p},type:"zoom-in"}))}};return c.a.createElement("div",{style:{background:"#ECECEC",padding:"5px"}},c.a.createElement(te.a,null,t.map((function(t,r){return c.a.createElement(ae.a,{xl:{span:8},lg:{span:12},md:{span:12},sm:{span:24},xs:{span:24},key:r},c.a.createElement(U.a,{style:{margin:"5px"},title:c.a.createElement("div",null,t.direction&&"rev"===t.direction?c.a.createElement(ne.a,{color:"#f50"},"Reverse"):null,t.helmet?c.a.createElement(ne.a,{color:"#f50"},"Without helmet"):null),extra:c.a.createElement(Z.a,{overlay:c.a.createElement(g.a,null,c.a.createElement(g.a.Item,{key:"0",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom image"),c.a.createElement(g.a.Item,{key:"1"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/vehicle/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Full image")),c.a.createElement(g.a.Item,{key:"2"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Cropped image")),c.a.createElement(g.a.Item,{key:"3"},c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(t)}},c.a.createElement(m.a,{type:"delete"})," ","Delete")))},c.a.createElement(W.a,null,"More ",c.a.createElement(m.a,{type:"down"}))),bordered:!0,cover:l===t.id?c.a.createElement(Xe.a,{src:"/public/anpr/vehicle/"+t.id+"/image.jpg",zoomFactor:s}):c.a.createElement("img",{alt:"event",src:"/public/anpr/vehicle/"+t.id+"/image.jpg"})},c.a.createElement("div",null,l===t.id?c.a.createElement(Be.a,{marks:f,min:o,max:u,onChange:e.updateZoomFactor,value:"number"===typeof s?s:0}):c.a.createElement("div",{style:{height:"54px",textAlign:"center"}},c.a.createElement(W.a,{size:"small",type:"primary",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom Image"))),c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+t.id+"/image.jpg"})),c.a.createElement("div",{style:{marginTop:"5px",textAlign:"center"},onClick:function(){return e.editEvent(t)}},c.a.createElement(rt,{strong:!0,editable:{onChange:e.updateEvent},copyable:!0},t.anprText),c.a.createElement(it,{type:"secondary"},a&&n.id===t.id?"saving...":""),c.a.createElement("div",null,c.a.createElement(it,{code:!0}," ",c.a.createElement(Me.a,{format:"lll"},t.eventDate)," ","|"," ",c.a.createElement(Me.a,{format:"LTS"},t.eventDate))),c.a.createElement("div",null,c.a.createElement(it,{code:!0},c.a.createElement(m.a,{type:"environment"})," ",t.location)))))}))),c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(Te.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:r,current:this.state.filter.page,pageSize:this.state.filter.pageSize})))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.events||0===this.state.events.Total)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?tt(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):tt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(at,{title:"Location",dataIndex:"location",key:"location",render:function(e){return e}}),c.a.createElement(at,{title:"Date",dataIndex:"eventDate",key:"eventDate",render:function(e){return c.a.createElement(Me.a,{format:"L"},e)}}),c.a.createElement(at,{title:"Time",dataIndex:"eventDate",key:"eventTime",render:function(e){return c.a.createElement(Me.a,{format:"LTS"},e)}}),c.a.createElement(at,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(e){return e}}),c.a.createElement(at,{title:"image",dataIndex:"id",key:"anprimage",render:function(e){return c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+e+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+e+"/image.jpg"}))}}),c.a.createElement(at,{title:"direction",dataIndex:"direction",key:"direction",render:function(e){return e}}),c.a.createElement(at,{title:"Helmet",dataIndex:"helmet",key:"helmet",render:function(e){return e?c.a.createElement("span",null,"No"):c.a.createElement("span",null,"Yes")}}),c.a.createElement(at,{title:"Action",key:"action",render:function(t,a){return c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(a)}},c.a.createElement(m.a,{type:"delete"})," ","Delete")}}))}}]),t}(o.Component),st=a(530),ot=a(270),ct=a(536);function ut(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var ht=$.a.Paragraph,dt=($.a.Text,he.a.Column),gt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!1,anprresponse:{},filter:{currentPage:1,pageSizes:24,lpr:"",incidentType:""}},a.toggleVisible=a.toggleVisible.bind(Object(A.a)(a)),a.refreshBriefIncidentsNow=a.refreshBriefIncidentsNow.bind(Object(A.a)(a)),a.onModalPageChange=a.onModalPageChange.bind(Object(A.a)(a)),a.onModalPageSizeChange=a.onModalPageSizeChange.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.state.filter;a.lpr==e.lpr&&a.incidentType==e.incidentType||(a.lpr=e.lpr,a.incidentType=e.incidentType,this.setState({filter:a},(function(){t.refreshBriefIncidentsNow()})))}},{key:"toggleVisible",value:function(){var e=this.state.filter;e.currentPage=1,this.setState({filter:e}),this.props.toggleVisible()}},{key:"refreshBriefIncidentsNow",value:function(){var e=this,t=this.state,a=t.loading,n=t.filter,r=t.anprresponse;n.lpr&&n.incidentType&&(this.setState({loading:!0}),Je.getBriefIncidentsRepeated(n).then((function(t){a=!1,r=t.data,e.setState({loading:a,anprresponse:r})})).catch((function(t){a=!1,e.setState({loading:a}),alert("Something went wrong")})))}},{key:"onModalPageChange",value:function(e,t){var a=this.state.filter;a.currentPage=e,a.pageSizes=t,this.refreshBriefIncidentsNow(a)}},{key:"onModalPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSizes=t,this.refreshBriefIncidentsNow(a)}},{key:"render",value:function(){var e=this.state.anprresponse.events,t=this.state.anprresponse.totalPages*this.state.anprresponse.pageSizes,a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ut(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ut(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!1,showQuickJumper:!1,pageSize:5,showLessItems:!0,onShowSizeChange:this.onModalPageSizeChange,onChange:this.onModalPageChange,total:t},{total:t,current:this.state.filter.currentPage,pageSizes:this.state.filter.pageSizes});if(this.state.loading){var n=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:n})}return this.state.anprresponse.events?c.a.createElement(Y.a,{title:c.a.createElement("div",null,this.state.filter.incidentType,c.a.createElement(ht,{copyable:!0},this.state.filter.lpr)),visible:this.props.visible,onCancel:this.toggleVisible,onClose:this.toggleVisible,footer:[c.a.createElement(W.a,{key:"close",type:"primary",onClick:this.toggleVisible},"Close")]},c.a.createElement("div",null,c.a.createElement(he.a,{dataSource:e,pagination:a},c.a.createElement(dt,{title:"When and Where",render:function(e,t,a){return c.a.createElement(ct.a.Item,null,c.a.createElement("div",null,c.a.createElement("p",null,c.a.createElement(m.a,{type:"clock-circle"}),"  ",c.a.createElement(Me.a,{format:"lll"},t.eventDate)),c.a.createElement("p",null,c.a.createElement(m.a,{type:"environment"})," ",t.location),c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+t.id+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+t.id+"/image.jpg",style:{width:160,height:"auto"}}))))}}),c.a.createElement(dt,{title:"Captured Image",dataIndex:"id",key:"anprimage",render:function(e){return c.a.createElement("a",{title:"click here to download",href:"/public/anpr/vehicle/"+e+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/vehicle/"+e+"/image.jpg",style:{width:200,height:"auto"}}))}})))):c.a.createElement(De.a,{description:!1})}}]),t}(o.Component);function mt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function pt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?mt(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):mt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}st.a.Link,we.a.Panel,$.a.Paragraph,$.a.Text;var ft=he.a.Column,vt=(ye.a.TabPane,re.a.Search),bt=(c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0}),[{key:"Reverse",tab:"Reverse"},{key:"Helmet-Missing",tab:"Helmet-Missing"}]),yt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).showModal=function(e){a.setState({visible:!0,timelineLpr:e})},a.state={activeTab:"Reverse",visible:!1,timelineLpr:"",filter:{lpr:""},helmetMissing:{loading:!1,anprresponse:{},filter:{pages:1,pageSizes:24,lpr:"",incidentType:""}},briefIncident:{loading:!1,anprresponse:{},filter:{lpr:""}},reverseDirection:{loading:!1,anprresponse:{},filter:{pagess:1,pageSizes:24,lpr:"",incidentType:""}}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(A.a)(a)),a.onHelmetMissingPageChange=a.onHelmetMissingPageChange.bind(Object(A.a)(a)),a.onReverseDirectionPageChange=a.onReverseDirectionPageChange.bind(Object(A.a)(a)),a.onHelmetMissingPageSizeChange=a.onHelmetMissingPageSizeChange.bind(Object(A.a)(a)),a.onReverseDirectionPageSizeChange=a.onReverseDirectionPageSizeChange.bind(Object(A.a)(a)),a.handleTabClick=a.handleTabClick.bind(Object(A.a)(a)),a.refreshHelmetMissingIncidentsNow=a.refreshHelmetMissingIncidentsNow.bind(Object(A.a)(a)),a.refreshReverseDirectionIncidentsNow=a.refreshReverseDirectionIncidentsNow.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a.search=a.search.bind(Object(A.a)(a)),a.onTabChange=a.onTabChange.bind(Object(A.a)(a)),a.toggleIncidentTimelineModal=a.toggleIncidentTimelineModal.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"handleTabClick",value:function(e){this.setState({activeTabIndex:e===this.state.activeTabIndex?this.props.defaultActiveTabIndex:e})}},{key:"refresh",value:function(){this.refreshHelmetMissingIncidentsNow(),this.refreshReverseDirectionIncidentsNow()}},{key:"toggleIncidentTimelineModal",value:function(){var e=this.state.visible;this.setState({visible:!e})}},{key:"refreshHelmetMissingIncidentsNow",value:function(){var e=this,t=this.state.helmetMissing;t.loading=!0,this.setState({helmetMissing:t}),Je.getHelmetMissingIncidentsRepeated(this.state.helmetMissing.filter).then((function(a){t.loading=!1,t.anprresponse=a.data,e.setState({helmetMissing:t})})).catch((function(a){t.loading=!1,e.setState({helmetMissing:t}),alert("Something went wrong")}))}},{key:"refreshReverseDirectionIncidentsNow",value:function(){var e=this,t=this.state.reverseDirection;t.loading=!0,this.setState({reverseDirection:t}),Je.getReverseDirectionIncidentsRepeated(this.state.reverseDirection.filter).then((function(a){t.loading=!1,t.anprresponse=a.data,e.setState({reverseDirection:t})})).catch((function(a){t.loading=!1,e.setState({hasError:!0}),alert("Something went wrong")}))}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,this.setState({filter:t})}},{key:"search",value:function(e){var t=this,a=this.state,n=a.filter,r=a.reverseDirection,i=a.helmetMissing;n.lpr=e,r.filter.lpr=e,i.filter.lpr=e,this.setState({filter:n,reverseDirection:r,helmetMissing:i},(function(){t.refresh()}))}},{key:"onHelmetMissingPageChange",value:function(e,t){var a=this.state.helmetMissing.filter;a.page=e,a.pageSize=t,this.refreshHelmetMissingIncidentsNow(a)}},{key:"onReverseDirectionPageChange",value:function(e,t){var a=this.state.reverseDirection.filter;a.pages=e,a.pageSizes=t,this.refreshReverseDirectionIncidentsNow(a)}},{key:"onHelmetMissingPageSizeChange",value:function(e,t){var a=this.state.helmetMissing.filter;a.pageSize=t,this.refreshHelmetMissingIncidentsNow(a)}},{key:"onReverseDirectionPageSizeChange",value:function(e,t){var a=this.state.reverseDirection.filter;a.pageSizes=t,this.refreshReverseDirectionIncidentsNow(a)}},{key:"onTabChange",value:function(e){this.setState({activeTab:e})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("div",null),c.a.createElement(U.a,{style:{width:"100%"},title:c.a.createElement(te.a,null,c.a.createElement(ae.a,{xl:{span:16},lg:{span:16},md:{span:12},sm:{span:12},xs:{span:12}},c.a.createElement("h4",null,"Repeated Incidents")),c.a.createElement(ae.a,{xl:{span:8},lg:{span:8},md:{span:12},sm:{span:12},xs:{span:12}},c.a.createElement(vt,{allowClear:!0,placeholder:"Search Vehicle ",onChange:this.onLprInputChange,style:{textAlign:"right"},onSearch:function(t){return e.search(t)},enterButton:!0}))),tabList:bt,activeTabKey:this.state.activeTab,onTabChange:function(t){e.onTabChange(t)}},"Reverse"===this.state.activeTab?this.renderReverseData():this.renderHelmetMissingData(),c.a.createElement(gt,{lpr:this.state.timelineLpr,incidentType:this.state.activeTab,visible:this.state.visible,toggleVisible:this.toggleIncidentTimelineModal})))}},{key:"renderReverseData",value:function(){var e=this,t=this.state.reverseDirection.anprresponse.events,a=this.state.reverseDirection.anprresponse.totalPages*this.state.reverseDirection.anprresponse.pageSizes,n=pt({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onReverseDirectionPageSizeChange,onChange:this.onReverseDirectionPageChange,total:a},{total:a,current:this.state.reverseDirection.filter.pages,pageSizes:this.state.reverseDirection.filter.pageSizes});if(this.state.reverseDirection.loading){var r=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:r})}return this.state.reverseDirection.anprresponse.events?c.a.createElement("div",null,c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(ft,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(t){return c.a.createElement(W.a,{onClick:function(){return e.showModal(t)}},t)}}),c.a.createElement(ft,{title:"Repeated Times",dataIndex:"repeatedTimes",key:"repeatedTimes",render:function(e){return e}}))):c.a.createElement(De.a,{description:!1})}},{key:"renderHelmetMissingData",value:function(){var e=this,t=this.state.helmetMissing.anprresponse.events,a=this.state.helmetMissing.anprresponse.totalPages*this.state.helmetMissing.anprresponse.pageSize,n=pt({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onHelmetMissingPageSizeChange,onChange:this.onHelmetMissingPageChange,total:a},{total:a,current:this.state.helmetMissing.filter.page,pageSize:this.state.helmetMissing.filter.pageSize});if(this.state.helmetMissing.loading){var r=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:r})}return this.state.helmetMissing.anprresponse.events?c.a.createElement("div",null,c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(ft,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(t){return c.a.createElement(W.a,{onClick:function(){return e.showModal(t)}},t)}}),c.a.createElement(ft,{title:"Repeated Times",dataIndex:"repeatedTimes",key:"repeatedTimes",render:function(e){return e}}))):c.a.createElement(De.a,{description:!1})}}]),t}(o.Component),Et=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getHotListedVehicles",value:function(e){return k.post("/api/hotlist/vehicle/list",e)}},{key:"saveHotListedVehicle",value:function(e){return k.post("/api/hotlist/vehicle/save",e)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),kt=a(97),Ct=re.a.Search,Ot=$.a.Text,St=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={activeModal:"",hotListedVehicleResponse:{},filter:{page:1,pageSize:40,lpr:""},workingVehicle:{id:void 0,lpr:"",archived:!1},loading:{vehiclesList:!1}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.onPageChange=a.onPageChange.bind(Object(A.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(A.a)(a)),a.openHotListVehicleForm=a.openHotListVehicleForm.bind(Object(A.a)(a)),a.handleSubmitWorkingHotListVehicle=a.handleSubmitWorkingHotListVehicle.bind(Object(A.a)(a)),a.handleCancelWorkingHotListVehicle=a.handleCancelWorkingHotListVehicle.bind(Object(A.a)(a)),a.archiveHotListedVehicle=a.archiveHotListedVehicle.bind(Object(A.a)(a)),a.workingVehicleOnChange=a.workingVehicleOnChange.bind(Object(A.a)(a)),a.search=a.search.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh(this.state.filter)}},{key:"refresh",value:function(e){var t=this,a=this.state.loading;a.vehiclesList=!0,this.setState({loading:a}),Et.getHotListedVehicles(e).then((function(e){a.vehiclesList=!1,t.setState({hotListedVehicleResponse:e.data,loading:a})})).catch((function(e){a.vehiclesList=!1,t.setState({loading:a}),de.a.error("Something went wrong!")}))}},{key:"archiveHotListedVehicle",value:function(e){var t=this;Et.archiveHotListedVehicle(e).then((function(e){t.refresh(t.state.filter),de.a.success("Vehicle archived!")})).catch((function(e){de.a.error("Something went wrong!")}))}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refresh(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refresh(a)}},{key:"confirm",value:function(e){console.log(e),de.a.success("Click on Yes")}},{key:"cancel",value:function(e){console.log(e),de.a.error("Click on No")}},{key:"openHotListVehicleForm",value:function(e){var t={id:void 0,lpr:"",archived:!1};e&&(t.id=e.id,t.lpr=e.lpr,t.archived=e.archived),this.setState({activeModal:"workingVehicle",workingVehicle:t})}},{key:"workingVehicleOnChange",value:function(e){var t=this.state.workingVehicle;switch(e.target.type){case"checkbox":t[e.target.name]=e.target.checked;break;default:t[e.target.name]=e.target.value}this.setState({workingVehicle:t})}},{key:"handleSubmitWorkingHotListVehicle",value:function(e){var t=this;Et.saveHotListedVehicle(this.state.workingVehicle).then((function(e){t.refresh(t.state.filter);var a={id:void 0,lpr:"",archived:!1};t.setState({activeModal:"",workingVehicle:a}),de.a.success("Saved!")})).catch((function(e){de.a.error("Something went wrong!")}))}},{key:"handleCancelWorkingHotListVehicle",value:function(e){var t={id:void 0,lpr:"",archived:!1};this.setState({activeModal:"",workingVehicle:t})}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,console.log(t),this.setState({filter:t})}},{key:"search",value:function(e){var t=this.state.filter;t.lpr=e,this.setState({filter:t}),this.refresh(t)}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,this.setState({filter:t})}},{key:"render",value:function(){var e=this,t=this.state,a=t.filter,n=t.hotListedVehicleResponse,r=t.workingVehicle,i=t.loading,l=n.events,s=n.totalPages*n.pageSize;if(i.vehiclesList){var o=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:o})}return c.a.createElement("div",null,c.a.createElement(te.a,null,c.a.createElement(ae.a,{xl:{span:8},lg:{span:8},md:{span:16},sm:{span:12},xs:{span:12}},c.a.createElement(Ct,{allowClear:!0,placeholder:"input search text",name:"lpr",value:a.lpr,onChange:this.onLprInputChange,onSearch:function(t){return e.search(t)},enterButton:!0}))),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement(te.a,null,c.a.createElement(ae.a,{xl:{span:3},lg:{span:4},md:{span:6},sm:{span:8},xs:{span:16},key:"new"},c.a.createElement(U.a,{style:{backgroundColor:"#40a9ff"},hoverable:!0,onClick:function(){return e.openHotListVehicleForm(void 0)}},c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(Ot,{style:{color:"white"},strong:!0},c.a.createElement(m.a,{type:"plus"})," New")))),(l||[]).map((function(t,a){return c.a.createElement(ae.a,{xl:{span:3},lg:{span:4},md:{span:6},sm:{span:8},xs:{span:16},key:a},c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(U.a,{hoverable:!0,onClick:function(){return e.openHotListVehicleForm(t)},style:{backgroundColor:t.archived?"#fafafa":""}},c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement(Ot,{delete:t.archived,strong:!0},t.lpr)))))}))),c.a.createElement(Y.a,{title:c.a.createElement("div",null,c.a.createElement(ne.a,null,r.id?"EDIT":"NEW")," ",c.a.createElement(Ot,{copyable:r.lpr.length>0},r.lpr)),visible:"workingVehicle"===this.state.activeModal,onOk:this.handleSubmitWorkingHotListVehicle,onCancel:this.handleCancelWorkingHotListVehicle},c.a.createElement(kt.a,{onChange:this.workingVehicleOnChange,name:"archived",checked:r.archived},"Archive"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(re.a,{onChange:this.workingVehicleOnChange,name:"lpr",value:r.lpr,size:"large",placeholder:"Enter vehicle number here"}))),n&&n.totalPages>1?c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(Te.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:s,current:this.state.filter.page,pageSize:this.state.filter.pageSize})):null))}}]),t}(o.Component);function jt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var wt=he.a.Column,Dt=we.a.Panel,It=$.a.Paragraph,Tt=$.a.Text,xt=[{key:"incidents",tab:"Incidents"},{key:"vehicles",tab:"Vehicles"}],Pt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={activeTab:"incidents",loading:!0,layout:"list",events:{},filter:{page:1,pageSize:12},workingEvent:{},workingEventLoading:!1,magnifyEvent:{magnifyEventId:"",zoomFactor:2,minZoomFactor:1,maxZoomFactor:5}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.handleFilterChange=a.handleFilterChange.bind(Object(A.a)(a)),a.handleLayoutChange=a.handleLayoutChange.bind(Object(A.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(A.a)(a)),a.onPageChange=a.onPageChange.bind(Object(A.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a.editEvent=a.editEvent.bind(Object(A.a)(a)),a.updateEvent=a.updateEvent.bind(Object(A.a)(a)),a.magnifyEvent=a.magnifyEvent.bind(Object(A.a)(a)),a.updateZoomFactor=a.updateZoomFactor.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;Je.getIncidentsHotlisted(this.state.filter).then((function(t){e.setState({anprresponse:t.data,loading:!1})}))}},{key:"refreshNow",value:function(e){var t=this;Je.getIncidentsHotlisted(this.state.filter).then((function(e){t.setState({anprresponse:e.data,loading:!1})}))}},{key:"archiveEvent",value:function(e){var t=this;Je.archiveEvent(e).then((function(e){t.refresh()}))}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,console.log(t),this.setState({filter:t})}},{key:"handleFilterChange",value:function(e){this.setState({filter:e})}},{key:"handleLayoutChange",value:function(e){this.setState({layout:e})}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"editEvent",value:function(e){this.setState({workingEvent:e})}},{key:"magnifyEvent",value:function(e){var t=this.state.magnifyEvent;t.magnifyEventId=e.id,this.setState({magnifyEvent:t})}},{key:"updateZoomFactor",value:function(e){var t=this.state.magnifyEvent;t.zoomFactor=e,this.setState({magnifyEvent:t})}},{key:"updateEvent",value:function(e){var t=this,a=this.state,n=a.workingEvent;a.workingEventLoading;n.anprText=e,this.setState({workingEvent:n,workingEventLoading:!0}),Je.updateEvent(n).then((function(a){var n=t.state,r=n.workingEvent;n.workingEventLoading;r.anprText=e,t.setState({workingEventLoading:!1})})).catch((function(e){alert("error in saving");t.state.workingEventLoading;t.setState({workingEventLoading:!1})}))}},{key:"onTabChange",value:function(e){"incidents"===e&&this.refresh(),this.setState({activeTab:e})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement(U.a,{style:{width:"100%"},title:"Hotlist",tabList:xt,activeTabKey:this.state.activeTab,onTabChange:function(t){e.onTabChange(t)}},"incidents"===this.state.activeTab?this.renderIncidents():c.a.createElement(St,null)))}},{key:"renderIncidents",value:function(){var e=this.state.layout,t=this.state.filter.lpr;return c.a.createElement("div",null,c.a.createElement(we.a,{bordered:!1,defaultActiveKey:["1"]},c.a.createElement(Dt,{header:"Filter",key:"1"},"LPR: ",c.a.createElement(re.a,{value:t,style:{width:"200px"},onChange:this.onLprInputChange})," ",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement(qe,{handleRefresh:this.refresh,filter:this.state.filter,layout:e,handleFilterChange:this.handleFilterChange,handleLayoutChange:this.handleLayoutChange})),c.a.createElement("div",null,"table"===e?this.renderTable():this.renderGrid())))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.anprresponse||0===this.state.anprresponse.totalPage)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.workingEventLoading,n=this.state.workingEvent,r=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,i=this.state.magnifyEvent,l=i.magnifyEventId,s=i.zoomFactor,o=i.minZoomFactor,u=i.maxZoomFactor,h=((u-o)/2).toFixed(5),d=s>=h?"":"rgba(0, 0, 0, .45)",p=s>=h?"rgba(0, 0, 0, .45)":"",f={1:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:d},type:"zoom-out"}))},2:{label:c.a.createElement("span",null,"2")},3:{label:c.a.createElement("span",null,"3")},4:{label:c.a.createElement("span",null,"4")},5:{label:c.a.createElement("span",null,c.a.createElement(m.a,{style:{color:p},type:"zoom-in"}))}};return c.a.createElement("div",{style:{background:"#ECECEC",padding:"5px"}},c.a.createElement(te.a,null,t.map((function(t,r){return c.a.createElement(ae.a,{xl:{span:8},lg:{span:12},md:{span:12},sm:{span:24},xs:{span:24},key:r},c.a.createElement(U.a,{style:{margin:"5px"},title:c.a.createElement("div",null,t.direction&&"rev"===t.direction?c.a.createElement(ne.a,{color:"#f50"},"Reverse"):null,t.helmet?c.a.createElement(ne.a,{color:"#f50"},"Without helmet"):null),extra:c.a.createElement(Z.a,{overlay:c.a.createElement(g.a,null,c.a.createElement(g.a.Item,{key:"0",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom image"),c.a.createElement(g.a.Item,{key:"1"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/vehicle/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Full image")),c.a.createElement(g.a.Item,{key:"2"},c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+t.id+"/image.jpg",download:!0},c.a.createElement(m.a,{type:"download"})," "," Cropped image")),c.a.createElement(g.a.Item,{key:"3"},c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(t)}},c.a.createElement(m.a,{type:"delete"})," ","Delete")))},c.a.createElement(W.a,null,"More ",c.a.createElement(m.a,{type:"down"}))),bordered:!0,cover:l===t.id?c.a.createElement(Xe.a,{src:"/public/anpr/vehicle/"+t.id+"/image.jpg",zoomFactor:s}):c.a.createElement("img",{alt:"event",src:"/public/anpr/vehicle/"+t.id+"/image.jpg"})},c.a.createElement("div",null,l===t.id?c.a.createElement(Be.a,{marks:f,min:o,max:u,onChange:e.updateZoomFactor,value:"number"===typeof s?s:0}):c.a.createElement("div",{style:{height:"54px",textAlign:"center"}},c.a.createElement(W.a,{size:"small",type:"primary",onClick:function(){return e.magnifyEvent(t)}},c.a.createElement(m.a,{type:"zoom-in"}),"Zoom Image"))),c.a.createElement("div",{style:{textAlign:"center"}},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+t.id+"/image.jpg"})),c.a.createElement("div",{style:{marginTop:"5px",textAlign:"center"},onClick:function(){return e.editEvent(t)}},c.a.createElement(It,{strong:!0,editable:{onChange:e.updateEvent},copyable:!0},t.anprText),c.a.createElement(Tt,{type:"secondary"},a&&n.id===t.id?"saving...":""),c.a.createElement("div",null,c.a.createElement(Tt,{code:!0}," ",c.a.createElement(Me.a,{format:"lll"},t.eventDate)," ","|"," ",c.a.createElement(Me.a,{format:"LTS"},t.eventDate))),c.a.createElement("div",null,c.a.createElement(Tt,{code:!0},c.a.createElement(m.a,{type:"environment"})," ",t.location)))))}))),c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement(Te.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:r,current:this.state.filter.page,pageSize:this.state.filter.pageSize})))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.events||0===this.state.events.Total)return c.a.createElement(De.a,{description:!1});var t=this.state.anprresponse.events,a=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jt(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(wt,{title:"Location",dataIndex:"location",key:"location",render:function(e){return e}}),c.a.createElement(wt,{title:"Date",dataIndex:"eventDate",key:"eventDate",render:function(e){return c.a.createElement(Me.a,{format:"L"},e)}}),c.a.createElement(wt,{title:"Time",dataIndex:"eventDate",key:"eventTime",render:function(e){return c.a.createElement(Me.a,{format:"LTS"},e)}}),c.a.createElement(wt,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(e){return e}}),c.a.createElement(wt,{title:"image",dataIndex:"id",key:"anprimage",render:function(e){return c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+e+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+e+"/image.jpg"}))}}),c.a.createElement(wt,{title:"direction",dataIndex:"direction",key:"direction",render:function(e){return e}}),c.a.createElement(wt,{title:"Helmet",dataIndex:"helmet",key:"helmet",render:function(e){return e?c.a.createElement("span",null,"No"):c.a.createElement("span",null,"Yes")}}),c.a.createElement(wt,{title:"Action",key:"action",render:function(t,a){return c.a.createElement(W.a,{type:"danger",onClick:function(){return e.archiveEvent(a)}},c.a.createElement(m.a,{type:"delete"})," ","Delete")}}))}}]),t}(o.Component);function zt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Lt=$.a.Paragraph,Mt=($.a.Text,he.a.Column),Ft=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loading:!1,anprresponse:{},filter:{currentPage:1,pageSizes:24,lpr:"",incidentType:""}},a.toggleVisible=a.toggleVisible.bind(Object(A.a)(a)),a.refreshBriefIncidentsNow=a.refreshBriefIncidentsNow.bind(Object(A.a)(a)),a.onModalPageChange=a.onModalPageChange.bind(Object(A.a)(a)),a.onModalPageSizeChange=a.onModalPageSizeChange.bind(Object(A.a)(a)),a.refreshBriefIncidentsNow=a.refreshBriefIncidentsNow.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.state.filter;a.lpr==e.lpr&&a.incidentType==e.incidentType||(a.lpr=e.lpr,a.incidentType=e.incidentType,this.setState({filter:a},(function(){t.refreshBriefIncidentsNow()})))}},{key:"toggleVisible",value:function(){var e=this.state.filter;e.currentPage=1,this.setState({filter:e}),this.props.toggleVisible()}},{key:"refreshBriefIncidentsNow",value:function(){var e=this,t=this.state,a=t.loading,n=t.filter,r=t.anprresponse;n.lpr&&n.incidentType&&(this.setState({loading:!0}),Je.getIncidentTimeline(n).then((function(t){a=!1,r=t.data,e.setState({loading:a,anprresponse:r})})).catch((function(t){a=!1,e.setState({loading:a}),alert("Something went wrong")})))}},{key:"onModalPageChange",value:function(e,t){var a=this.state.filter;a.currentPage=e,a.pageSizes=t,this.refreshBriefIncidentsNow(a)}},{key:"onModalPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSizes=t,this.refreshBriefIncidentsNow(a)}},{key:"render",value:function(){var e=this.state.anprresponse.events,t=this.state.anprresponse.totalPages*this.state.anprresponse.pageSizes,a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?zt(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!1,showQuickJumper:!1,pageSize:5,showLessItems:!0,onShowSizeChange:this.onModalPageSizeChange,onChange:this.onModalPageChange,total:t},{total:t,current:this.state.filter.currentPage,pageSizes:this.state.filter.pageSizes});if(this.state.loading){var n=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:n})}return this.state.anprresponse.events?c.a.createElement(Y.a,{title:c.a.createElement("div",null,c.a.createElement(Lt,{copyable:!0},this.state.filter.lpr)),visible:this.props.visible,onCancel:this.toggleVisible,onClose:this.toggleVisible,footer:[c.a.createElement(W.a,{key:"close",type:"primary",onClick:this.toggleVisible},"Close")]},c.a.createElement("div",null,c.a.createElement(he.a,{dataSource:e,pagination:a},c.a.createElement(Mt,{title:"When and Where",render:function(e,t,a){return c.a.createElement(ct.a.Item,null,c.a.createElement("div",null,c.a.createElement("p",null,c.a.createElement(m.a,{type:"clock-circle"}),"  ",c.a.createElement(Me.a,{format:"lll"},t.eventDate)),c.a.createElement("p",null,c.a.createElement(m.a,{type:"environment"})," ",t.location),c.a.createElement("a",{title:"click here to download",href:"/public/anpr/lpr/"+t.id+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/lpr/"+t.id+"/image.jpg",style:{width:160,height:"auto"}}))))}}),c.a.createElement(Mt,{title:"Captured Image",dataIndex:"id",key:"anprimage",render:function(e){return c.a.createElement("a",{title:"click here to download",href:"/public/anpr/vehicle/"+e+"/image.jpg",download:!0},c.a.createElement("img",{alt:"event",src:"/public/anpr/vehicle/"+e+"/image.jpg",style:{width:200,height:"auto"}}))}})))):c.a.createElement(De.a,{description:!1})}}]),t}(o.Component);function Nt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}st.a.Link,we.a.Panel,$.a.Paragraph,$.a.Text;var Rt=he.a.Column,Vt=(ye.a.TabPane,re.a.Search),At=(c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0}),function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).showModal=function(e){a.setState({visible:!0,timelineLpr:e})},a.state={archiveEventsLoading:"",activeTab:"All-Incidents",visible:!1,timelineLpr:"",filter:{lpr:""},archiveLpr:{anprresponse:{},lpr:""},allData:{loading:!1,anprresponse:{},filter:{pages:1,pageSizes:24,lpr:"",incidentType:""}}},a.refresh=a.refresh.bind(Object(A.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(A.a)(a)),a.onMasterDataPageChange=a.onMasterDataPageChange.bind(Object(A.a)(a)),a.onMasterDataPageSizeChange=a.onMasterDataPageSizeChange.bind(Object(A.a)(a)),a.handleTabClick=a.handleTabClick.bind(Object(A.a)(a)),a.refreshIncidentsNow=a.refreshIncidentsNow.bind(Object(A.a)(a)),a.onLprInputChange=a.onLprInputChange.bind(Object(A.a)(a)),a.search=a.search.bind(Object(A.a)(a)),a.onTabChange=a.onTabChange.bind(Object(A.a)(a)),a.toggleIncidentTimelineModal=a.toggleIncidentTimelineModal.bind(Object(A.a)(a)),a.archiveLprOnChange=a.archiveLprOnChange.bind(Object(A.a)(a)),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"handleTabClick",value:function(e){this.setState({activeTabIndex:e===this.state.activeTabIndex?this.props.defaultActiveTabIndex:e})}},{key:"refresh",value:function(){this.refreshIncidentsNow()}},{key:"toggleIncidentTimelineModal",value:function(){var e=this.state.visible;this.setState({visible:!e})}},{key:"refreshIncidentsNow",value:function(){var e=this,t=this.state.allData;t.loading=!0,this.setState({allData:t}),Je.getIncidentsList(this.state.allData.filter).then((function(a){t.loading=!1,t.anprresponse=a.data,e.setState({allData:t})})).catch((function(a){t.loading=!1,e.setState({hasError:!0}),alert("Something went wrong")}))}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onLprInputChange",value:function(e){var t=this.state.filter;t.lpr=e.target.value,this.setState({filter:t})}},{key:"search",value:function(e){var t=this,a=this.state,n=a.filter,r=a.allData;n.lpr=e,r.filter.lpr=e,this.setState({filter:n,allData:r},(function(){t.refresh()}))}},{key:"onMasterDataPageChange",value:function(e,t){var a=this.state.allData.filter;a.pages=e,a.pageSizes=t,this.refreshIncidentsNow(a)}},{key:"onMasterDataPageSizeChange",value:function(e,t){var a=this.state.allData.filter;a.pageSizes=t,this.refreshIncidentsNow(a)}},{key:"onTabChange",value:function(e){this.setState({activeTab:e})}},{key:"archiveLprOnChange",value:function(e){var t=this;this.setState({archiveEventsLoading:e}),Je.archiveAllEvent(e).then((function(e){t.setState({archiveEventsLoading:""}),t.refresh(t.state.archiveLpr),de.a.success("Vehicle archived!")})).catch((function(e){t.setState({archiveEventsLoading:""}),de.a.error("Something went wrong!")}))}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("div",null),c.a.createElement(U.a,{style:{width:"100%"},title:c.a.createElement(te.a,null,c.a.createElement(ae.a,{xl:{span:16},lg:{span:16},md:{span:12},sm:{span:12},xs:{span:12}},c.a.createElement("h4",null,"Master-Anpr-Data")),c.a.createElement(ae.a,{xl:{span:8},lg:{span:8},md:{span:12},sm:{span:12},xs:{span:12}},c.a.createElement(Vt,{allowClear:!0,placeholder:"Search Vehicle ",onChange:this.onLprInputChange,style:{textAlign:"right"},onSearch:function(t){return e.search(t)},enterButton:!0}))),onTabChange:function(t){e.onTabChange(t)}},this.renderMasterData(),c.a.createElement(Ft,{lpr:this.state.timelineLpr,incidentType:this.state.activeTab,visible:this.state.visible,toggleVisible:this.toggleIncidentTimelineModal})))}},{key:"renderMasterData",value:function(){var e=this,t=this.state.allData.anprresponse.events,a=this.state.allData.anprresponse.totalPages*this.state.allData.anprresponse.pageSizes,n=(this.state.archiveLpr,function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Nt(a,!0).forEach((function(t){Object(V.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Nt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onMasterDataPageSizeChange,onChange:this.onMasterDataPageChange,total:a},{total:a,current:this.state.allData.filter.pages,pageSizes:this.state.allData.filter.pageSizes}));if(this.state.allData.loading){var r=c.a.createElement(m.a,{type:"loading",style:{fontSize:24},spin:!0});return c.a.createElement(ot.a,{indicator:r})}return this.state.allData.anprresponse.events?c.a.createElement("div",null,c.a.createElement(he.a,{dataSource:t,pagination:n},c.a.createElement(Rt,{title:"LPR",dataIndex:"anprText",key:"anprText",render:function(t){return c.a.createElement(W.a,{onClick:function(){return e.showModal(t)}},t)}}),c.a.createElement(Rt,{title:"Incident Count",dataIndex:"repeatedTimes",key:"repeatedTimes",render:function(e){return e}}),c.a.createElement(Rt,{render:function(t,a,n){return c.a.createElement("div",null,c.a.createElement("p",null,c.a.createElement(W.a,{type:"danger",loading:e.state.archiveEventsLoading===a.anprText,onClick:function(){return e.archiveLprOnChange(a.anprText)}},"Archive")))}}))):c.a.createElement(De.a,{description:!1})}}]),t}(o.Component)),Ht=d.a.Content,Bt=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).state={loggedIn:!1},w.EventBus.subscribe("login-logout",(function(e){return a.refreshMenu(e)})),a}return Object(s.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refreshMenu()}},{key:"refreshMenu",value:function(){this.setState({loggedIn:D.isLoggedIn()})}},{key:"render",value:function(){var e=this.state.loggedIn,t=e?c.a.createElement(x,null):null,a=e?c.a.createElement(z,{isLoggedIn:e}):null;return c.a.createElement("div",{className:"App"},c.a.createElement(d.a,{style:{minHeight:"100vh"}},t,c.a.createElement(d.a,null,a,c.a.createElement(Ht,{style:{margin:"24px 16px 0"}},c.a.createElement("div",{style:{padding:4}},c.a.createElement(N.b,{path:"/login",exact:!0,component:je}),c.a.createElement(R,{path:"/",exact:!0,component:K}),c.a.createElement(R,{path:"/incidents",exact:!0,component:lt}),c.a.createElement(R,{path:"/incidents/hotlisted",exact:!0,component:Pt}),c.a.createElement(R,{path:"/incidents/repeated",exact:!0,component:yt}),c.a.createElement(R,{path:"/anpr",exact:!0,component:et}),c.a.createElement(R,{path:"/anpr/masterdata",exact:!0,component:At}),c.a.createElement(R,{path:"/user",exact:!0,component:ve}),c.a.createElement(R,{path:"/feed",exact:!0,component:se}),c.a.createElement(R,{path:"/trigger",exact:!0,component:Ze}),c.a.createElement(R,{path:"/device",exact:!0,component:ue}),c.a.createElement(R,{path:"/device/conf",exact:!0,component:ke}))),c.a.createElement(M,null))))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Yt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(p.a,null,c.a.createElement(N.d,null,c.a.createElement(Bt,null)))}}]),t}(c.a.Component);h.a.render(c.a.createElement(Yt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},63:function(e,t){e.exports={EventBus:{events:{},publish:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))},subscribe:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}}}}},[[279,1,2]]]);
//# sourceMappingURL=main.dbf0fa9a.chunk.js.map