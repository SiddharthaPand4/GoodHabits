(window.webpackJsonpsynvisionweb=window.webpackJsonpsynvisionweb||[]).push([[0],{114:function(e,t){e.exports={EventBus:{events:{},publish:function(e,t){this.events[e]&&this.events[e].forEach(function(e){return e(t)})},subscribe:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}}}},218:function(e,t,n){e.exports=n(418)},223:function(e,t,n){},224:function(e,t,n){},418:function(e,t,n){"use strict";n.r(t);var a=n(17),r=n(18),i=n(21),c=n(20),l=n(22),o=n(0),s=n.n(o),u=n(8),m=n.n(u),d=(n(223),n(224),n(419)),h=n(156),p=n(9),f=n(39),v=d.a.Sider,b=h.a.SubMenu,E=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(v,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},s.a.createElement("div",{className:"logo"}),s.a.createElement(h.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},s.a.createElement(h.a.Item,{key:"1"},s.a.createElement(p.a,{type:"alert"}),s.a.createElement("span",{className:"nav-text"},s.a.createElement(f.c,{to:"/incidents",className:"nav-text"},"Incidents"))),s.a.createElement(h.a.Item,{key:"2"},s.a.createElement(p.a,{type:"video-camera"}),s.a.createElement("span",{className:"nav-text"},s.a.createElement(f.c,{to:"/feed",className:"nav-text"},"Feed"))),s.a.createElement(b,{key:"admin",title:s.a.createElement("span",null,s.a.createElement(p.a,{type:"deployment-unit"}),"Admin")},s.a.createElement(h.a.Item,{key:"3"},s.a.createElement(p.a,{type:"user"}),s.a.createElement("span",{className:"nav-text"},s.a.createElement(f.c,{to:"/user",className:"nav-text"},"Users"))),s.a.createElement(h.a.Item,{key:"4"},s.a.createElement(p.a,{type:"laptop"}),s.a.createElement("span",{className:"nav-text"},s.a.createElement(f.c,{to:"/device",className:"nav-text"},"Device"))))))}}]),t}(o.Component),g=d.a.Header,y=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(g,{style:{background:"#fff",padding:10}},"\xa0")}}]),t}(o.Component),O=d.a.Footer,k=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(O,{style:{textAlign:"center"}},"SynergyLabs \xa9 2019")}}]),t}(o.Component),j=n(215),I=n(59),w=n(151),x=n.n(w),S=n(205),C=n(50),D=n.n(C),L=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,[{key:"getUser",value:function(){return D.a.get("/api/user/")}},{key:"getUsers",value:function(){return D.a.get("/api/users")}},{key:"isLoggedIn",value:function(){return JSON.parse(localStorage.getItem("syntoken"))?(console.log("located token, returning true"),!0):(console.log("cannot locate token, returning false"),!1)}},{key:"login",value:function(){var e=Object(S.a)(x.a.mark(function e(t,n){var a,r;return x.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.post("/api/login",JSON.stringify({username:t,password:n}));case 2:return a=e.sent,console.log("got this response",a),(r=a.data)&&localStorage.setItem("syntoken",JSON.stringify(r)),e.abrupt("return",r);case 7:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),N=function(e){var t=e.component,n=Object(j.a)(e,["component"]);return s.a.createElement(I.b,Object.assign({},n,{render:function(e){return L.isLoggedIn()?s.a.createElement(t,e):s.a.createElement(I.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},M=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,"this is home view")}}]),t}(o.Component),T=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("img",{src:"http://192.168.0.64:9000",height:"400",width:"400"}))}}]),t}(o.Component),V=n(427),A=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,[{key:"getDevice",value:function(){return D.a.get("/api/device")}},{key:"getDeviceConfig",value:function(){return D.a.get("/api/device/config")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),B=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={loading:!0,device:{}},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;A.getDevice().then(function(t){e.setState({device:t.data,loading:!1})})}},{key:"render",value:function(){var e=this.state.loading,t=this.state.device;return e?s.a.createElement("div",null,"Loading.."):s.a.createElement("div",null,s.a.createElement(V.a,{title:"Device details",style:{width:300},extra:s.a.createElement(f.b,{to:"/device/conf"},s.a.createElement(p.a,{type:"setting"}))},s.a.createElement("p",null,"ID: ",t.fingerprint),s.a.createElement("p",null,"Name:",t.name),s.a.createElement("p",null,"Model:",t.model),s.a.createElement("p",null,"License:",t.license),s.a.createElement("p",null,"Status: ",t.status),s.a.createElement("p",null,"RegisteredTo: ",t.registeredTo)))}}]),t}(o.Component),F=n(421),_=n(420),P=F.a.Column,U=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={loading:!0,users:[]},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;L.getUsers().then(function(t){e.setState({users:t.data,loading:!1})})}},{key:"render",value:function(){return s.a.createElement(F.a,{dataSource:this.state.users},s.a.createElement(P,{title:"Username",dataIndex:"username",key:"username",render:function(e,t){return s.a.createElement("span",null,s.a.createElement("a",{href:"user/"+t.ID},e))}}),s.a.createElement(P,{title:"Email",dataIndex:"email",key:"email"}),s.a.createElement(P,{title:"Token",dataIndex:"token",key:"token"}),s.a.createElement(P,{title:"Action",key:"action",render:function(e,t){return s.a.createElement("span",null,s.a.createElement("a",null,"Edit ",t.lastName),s.a.createElement(_.a,{type:"vertical"}),s.a.createElement("a",null,"Delete"))}}))}}]),t}(o.Component),J=n(155),G=J.a.TabPane,K=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={loading:!0,deviceconfig:{}},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;A.getDeviceConfig().then(function(t){e.setState({deviceconfig:t.data,loading:!1})})}},{key:"onTabChange",value:function(e){console.log("tab changed",e)}},{key:"render",value:function(){return s.a.createElement(J.a,{defaultActiveKey:"1",onChange:this.onTabChange},s.a.createElement(G,{tab:"Feed",key:"common"},"Feed details"),s.a.createElement(G,{tab:"Basic Intrusion",key:"bi"},"Basic Intrusion"),s.a.createElement(G,{tab:"Advanced Intrusion",key:"ai"},"Advanced Intrusion"))}}]),t}(o.Component),W=n(114),q=n(56),z=n(423),H=n(422),R=n(78),$=n(44),Q=n(426),X=n(36),Y=n(33),Z=Object(Y.a)(),ee=z.a.Text,te=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){L.isLoggedIn()&&Z.push("/")}},{key:"render",value:function(){var e=H.a.create({name:"login_form"})(ne);return s.a.createElement(e,null)}}]),t}(o.Component),ne=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},n.handleSubmit=n.handleSubmit.bind(Object(q.a)(n)),n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var n=this.props.form,a=n.getFieldValue("username"),r=n.getFieldValue("password");this.setState({submitted:!0}),a&&r&&(this.setState({loading:!0}),L.login(a,r).then(function(e){Z.push("/"),W.EventBus.publish("login-logout",{})}).catch(function(e){t.setState({loginError:"Something went wrong, please try again",loading:!1})}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.loginError;return s.a.createElement(R.a,null,s.a.createElement($.a,{span:8,offset:8},s.a.createElement("h4",null,"Login"),s.a.createElement(H.a,{onSubmit:this.handleSubmit,className:"login-form"},s.a.createElement(H.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(s.a.createElement(Q.a,{prefix:s.a.createElement(p.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),s.a.createElement(H.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(s.a.createElement(Q.a,{prefix:s.a.createElement(p.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),s.a.createElement(H.a.Item,null,s.a.createElement(X.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))),t&&s.a.createElement(ee,{type:"danger"},t)))}}]),t}(o.Component),ae=Object(I.g)(te),re=n(79),ie=n(428),ce=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,[{key:"getIncidents",value:function(){return D.a.get("/api/incidents")}},{key:"archiveIncident",value:function(e){return D.a.delete("/api/incident/"+e.ID)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),le=n(152),oe=n.n(le),se=n(425),ue=n(153),me=n.n(ue),de=n(424),he=de.a.Panel,pe=(V.a.Meta,X.a.Group),fe=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,layout:"table",incidents:{}},n.handleDone=n.handleDone.bind(Object(q.a)(n)),n.archiveIncident=n.archiveIncident.bind(Object(q.a)(n)),n.refresh=n.refresh.bind(Object(q.a)(n)),n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;ce.getIncidents().then(function(t){e.setState({incidents:t.data,loading:!1})})}},{key:"archiveIncident",value:function(e){var t=this;ce.archiveIncident(e).then(function(){t.refresh()})}},{key:"changeLayout",value:function(e){this.setState({layout:e})}},{key:"showVideo",value:function(e){oe.a.canPlay("/api/incident/video/"+this.state.videoid+"/video.mp4");this.setState({videoVisible:!0,videoid:e})}},{key:"handleDone",value:function(){this.setState({videoVisible:!1,videoid:""})}},{key:"render",value:function(){var e=this;if(this.state.loading||!this.state.incidents)return s.a.createElement(re.a,{description:!1});var t=this.state.layout;return s.a.createElement(de.a,{bordered:!1,defaultActiveKey:["1"]},s.a.createElement(he,{header:"Filter",key:"1"},s.a.createElement(pe,null,s.a.createElement(X.a,{type:"list"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("list")}}),s.a.createElement(X.a,{type:"table"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("table")}}))),s.a.createElement(he,{header:"Incidents",key:"2"},"table"===t?this.renderGrid():this.renderList()))}},{key:"renderGrid",value:function(){var e=this,t=this.state.incidents;return s.a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},s.a.createElement(se.a,{title:"Video",visible:this.state.videoVisible,onOk:this.handleDone,onCancel:this.handleDone},this.state.videoVisible?s.a.createElement(oe.a,{controls:!0,url:"http://localhost:9000/api/incident/video/"+this.state.videoid+"/video.mp4",width:"300"}):s.a.createElement("div",null,s.a.createElement(re.a,null))),s.a.createElement(R.a,{gutter:16},t.map(function(t,n){return s.a.createElement($.a,{span:8,key:n},s.a.createElement(V.a,{title:s.a.createElement("div",null,s.a.createElement(ie.a,{color:"#f50"},t.event_type),s.a.createElement(ie.a,{color:"#2db7f5"},t.event_date),s.a.createElement(ie.a,{color:"#87d068"},s.a.createElement("span",null,s.a.createElement(me.a,{format:"LTS"},t.event_start)),s.a.createElement(p.a,{type:"right"}),s.a.createElement("span",null,s.a.createElement(me.a,{format:"LTS"},t.event_end))),s.a.createElement(ie.a,{color:"#108ee9"},t.event_duration,"s")),bordered:!0,cover:s.a.createElement("img",{alt:"incident image",src:"/api/incident/image/"+t.image_id}),actions:[s.a.createElement(p.a,{type:"right",key:"play",onClick:function(){return e.showVideo(t.video_id)}}),s.a.createElement(p.a,{type:"edit",key:"edit"}),s.a.createElement(p.a,{type:"delete",key:"delete",onClick:function(){return e.archiveIncident(t)}})]}))})))}},{key:"renderList",value:function(){this.state.incidents;return s.a.createElement("div",null,"list")}}]),t}(o.Component),ve=d.a.Content,be=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={loggedIn:!1},W.EventBus.subscribe("login-logout",function(e){return n.refreshMenu(e)}),n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refreshMenu()}},{key:"refreshMenu",value:function(){this.setState({loggedIn:L.isLoggedIn()})}},{key:"render",value:function(){var e=this.state.loggedIn,t=e?s.a.createElement(E,null):null,n=e?s.a.createElement(y,{isLoggedIn:e}):null;return s.a.createElement("div",{className:"App"},s.a.createElement(d.a,null,t,s.a.createElement(d.a,null,n,s.a.createElement(ve,{style:{margin:"24px 16px 0"}},s.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},s.a.createElement(I.b,{path:"/login",exact:!0,component:ae}),s.a.createElement(N,{path:"/",exact:!0,component:M}),s.a.createElement(N,{path:"/incidents",exact:!0,component:fe}),s.a.createElement(N,{path:"/user",exact:!0,component:U}),s.a.createElement(N,{path:"/feed",exact:!0,component:T}),s.a.createElement(N,{path:"/device",exact:!0,component:B}),s.a.createElement(N,{path:"/device/conf",exact:!0,component:K}))),s.a.createElement(k,null))))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ee=function(e){function t(){return Object(a.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement(f.a,null,s.a.createElement(I.d,null,s.a.createElement(be,null)))}}]),t}(s.a.Component);m.a.render(s.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[218,1,2]]]);
//# sourceMappingURL=main.cf77362c.chunk.js.map