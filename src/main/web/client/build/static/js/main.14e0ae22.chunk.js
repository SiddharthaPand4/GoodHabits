(window.webpackJsonpsynvisionweb=window.webpackJsonpsynvisionweb||[]).push([[0],{267:function(e,t,a){e.exports=a(511)},272:function(e,t,a){},273:function(e,t,a){},475:function(e,t,a){},511:function(e,t,a){"use strict";a.r(t);var n=a(17),r=a(18),i=a(23),s=a(22),l=a(24),o=a(0),c=a.n(o),u=a(8),h=a.n(u),m=(a(272),a(273),a(512)),d=a(188),g=a(11),f=a(39),p=m.a.Sider,v=d.a.SubMenu,y=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(p,{breakpoint:"lg",collapsedWidth:"0",onBreakpoint:function(e){console.log(e)},onCollapse:function(e,t){console.log(e,t)}},c.a.createElement("div",{className:"logo"}),c.a.createElement(d.a,{theme:"dark",mode:"inline",defaultSelectedKeys:["0"]},c.a.createElement(d.a.Item,{key:"0"},c.a.createElement(f.b,{to:"/"},c.a.createElement(g.a,{type:"home"}),c.a.createElement("span",{className:"nav-text"},"Home"))),c.a.createElement(d.a.Item,{key:"1",className:"sidebar-nav-link"},c.a.createElement(f.b,{to:"/incidents"},c.a.createElement(g.a,{type:"alert"}),c.a.createElement("span",{className:"nav-text"},"Incidents"))),c.a.createElement(d.a.Item,{key:"6",className:"sidebar-nav-link"},c.a.createElement(f.b,{to:"/anpr"},c.a.createElement(g.a,{type:"box-plot"}),c.a.createElement("span",{className:"nav-text"},"ANPR"))),c.a.createElement(d.a.Item,{key:"2"},c.a.createElement(f.b,{to:"/feed"},c.a.createElement(g.a,{type:"video-camera"}),c.a.createElement("span",{className:"nav-text"},"Feed"))),c.a.createElement(v,{key:"admin",title:c.a.createElement("span",null,c.a.createElement(g.a,{type:"deployment-unit"}),"Admin")},c.a.createElement(d.a.Item,{key:"3"},c.a.createElement(f.b,{to:"/user"},c.a.createElement(g.a,{type:"user"}),c.a.createElement("span",{className:"nav-text"},"Users"))),c.a.createElement(d.a.Item,{key:"4"},c.a.createElement(f.b,{to:"/device"},c.a.createElement(g.a,{type:"laptop"}),c.a.createElement("span",{className:"nav-text"},"Device"))),c.a.createElement(d.a.Item,{key:"5"},c.a.createElement(f.b,{to:"/trigger"},c.a.createElement(g.a,{type:"clock-circle"}),c.a.createElement("span",{className:"nav-text"},"Triggers"))))))}}]),t}(o.Component),b=m.a.Header,E=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(b,{style:{background:"#fff",padding:10}},"\xa0")}}]),t}(o.Component),k=m.a.Footer,O=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(k,{style:{textAlign:"center"}},"SynergyLabs \xa9 2019")}}]),t}(o.Component),C=a(264),j=a(72),S=a(183),D=a.n(S),T=a(245),w=a(184),I=a.n(w);var N=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,null,[{key:"Instance",value:function(){var e=new I.a.create({baseURL:"/",timeout:5e3,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use((function(e){var t=JSON.parse(localStorage.getItem("syntoken"));return t&&(e.headers.Authorization="Bearer "+t.token),e})),I.a.interceptors.response.use(void 0,(function(e){return e.response.config.url.includes("/login")?Promise.reject(e):403===e.response.status?(localStorage.clear(),void(window.location="/login")):401!==e.response.status?Promise.reject(e):void 0})),e}}]),e}().Instance();function P(){var e=JSON.parse(localStorage.getItem("syntoken"));return e?{Authorization:"Bearer "+e,Accept:"application/json","Content-Type":"application/json"}:{Accept:"application/json","Content-Type":"application/json"}}var F="/",x=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getUser",value:function(e){return N.get("/api/user/"+e)}},{key:"getUsers",value:function(){return N.get("/api/user/")}},{key:"getRoles",value:function(){return N.get("/api/user/roles")}},{key:"createUser",value:function(e){var t={userName:e.userName,lastName:e.lastName,firstName:e.firstName,email:e.email,id:e.id,roles:e.roles},a={method:"POST",headers:P(),data:JSON.stringify(t),url:F+"api/user/"};return e.id&&(a.method="PUT"),N(a)}},{key:"deleteUser",value:function(e){return N.delete("/api/user/"+e)}},{key:"isLoggedIn",value:function(){return JSON.parse(localStorage.getItem("syntoken"))?(console.log("located token, returning true"),!0):(console.log("cannot locate token, returning false"),!1)}},{key:"login",value:function(){var e=Object(T.a)(D.a.mark((function e(t,a){var n,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.post("/login",JSON.stringify({username:t,password:a}),{headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,console.log("got this response",n),(r=n.data)&&localStorage.setItem("syntoken",JSON.stringify(r)),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),V=function(e){var t=e.component,a=Object(C.a)(e,["component"]);return c.a.createElement(j.b,Object.assign({},a,{render:function(e){return x.isLoggedIn()?c.a.createElement(t,e):c.a.createElement(j.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},z=a(14),L=a(515),M=a(107),U=a(523),A=a(95),B=a(55),Y=a(521),R=a(524),W=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getTotalNoOfVehiclesBetweenTwoDates",value:function(e){return N.post("/api/dashboard/vehiclescount/datefilter",e)}},{key:"getTotalNoOfVehiclesBySelectedDate",value:function(e){return N.post("/api/dashboard/vehiclescount/date",e)}},{key:"getTotalNoOfVehiclesForLastMonths",value:function(e){return N.post("/api/dashboard/vehiclescount/month",e)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),q=a(16),J=a.n(q),H=(a(2),a(246)),G=(a(421),L.a.RangePicker),K=M.a.Option,_=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,layout:"table",incidents:{},filter:{filterType:"today"},resultSetByDate:{loading:!0,chartData:{}},resultSetByTime:{loading:!0,chartData:{}},aggregation:"",isOpenDatePicker:!1},a.refresh=a.refresh.bind(Object(z.a)(a)),a.onChange=a.onChange.bind(Object(z.a)(a)),a.onOk=a.onOk.bind(Object(z.a)(a)),a.fetchDateWiseVehiclesCount=a.fetchDateWiseVehiclesCount.bind(Object(z.a)(a)),a.handleChange=a.handleChange.bind(Object(z.a)(a)),a.openDatePicker=a.openDatePicker.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){this.fetchDateWiseVehiclesCount()}},{key:"fetchDateWiseVehiclesCount",value:function(){var e=this;W.getTotalNoOfVehiclesBetweenTwoDates(this.state.filter).then((function(t){for(var a=[],n=[],r=0;r<t.data.length;r++)a.push(t.data[r].key),n.push(t.data[r].countOfTotalVehicles);var i={loading:!1,chartData:{labels:a,datasets:[{label:a,data:n}]}};e.setState({resultSetByDate:i,isOpenDatePicker:!1})}),(function(e){U.a.error(e.response.data.message)}))}},{key:"handleChange",value:function(e){var t=this.state.filter;t.filterType=e,this.setState({aggregation:e,filter:t,isOpenDatePicker:!1}),"custom"!=e&&this.fetchDateWiseVehiclesCount(),"custom"==e&&this.setState({isOpenDatePicker:!0})}},{key:"openDatePicker",value:function(){this.setState({isOpenDatePicker:!0})}},{key:"onChange",value:function(e,t){console.log("Selected Time: ",e),console.log("Formatted Selected Time: ",t);var a=this.state.filter;a.from=e[0],a.to=e[1]}},{key:"onOk",value:function(e){console.log("onOk: ",e),this.setState({isOpenDatePicker:!1}),this.fetchDateWiseVehiclesCount()}},{key:"render",value:function(){var e=this.onChange;return c.a.createElement("div",null,c.a.createElement(A.a,{gutter:24},c.a.createElement(B.a,{span:12},c.a.createElement(Y.a,{title:"Incidents (This Week)",value:24})),c.a.createElement(B.a,{span:12},c.a.createElement(Y.a,{title:"Incidents (Last Week)",value:34}))),c.a.createElement(A.a,{gutter:16},c.a.createElement(B.a,{span:16},c.a.createElement(R.a,null,c.a.createElement(M.a,{defaultValue:"today",style:{width:120},onChange:this.handleChange},c.a.createElement(K,{value:"yesterday"},"Yesterday"),c.a.createElement(K,{value:"today"},"Today"),c.a.createElement(K,{value:"last7days"},"Last 7 days"),c.a.createElement(K,{value:"last3months"},"Last 3 months"),c.a.createElement(K,{value:"last6months"},"Last 6 months"),c.a.createElement(K,{value:"custom",onClick:this.openDatePicker},"Custom")),"\xa0 \xa0",this.state.isOpenDatePicker?c.a.createElement(G,{open:this.state.isOpenDatePicker,ranges:{"This Month":[J()().startOf("month"),J()().endOf("month")],"This Week":[J()().startOf("week"),J()().endOf("week")]},defaultValue:[J()().startOf("week"),J()().endOf("week")],format:"YYYY/MM/DD",onChange:e,onOk:this.onOk,showTime:!0}):null,"\xa0 \xa0",this.state.resultSetByDate.loading?null:c.a.createElement(H.a,{data:this.state.resultSetByDate.chartData,options:{title:{display:!0,text:"Vehicles"},options:{maintainAspectRatio:!1,responsive:!0},legend:{display:!1},scales:{yAxes:[{ticks:{beginAtZero:!0},scaleLabel:{display:!0,labelString:"Total no of vehicles"}}],xAxes:[{scaleLabel:{display:!0,labelString:"Date"}}]},tooltips:{callbacks:{title:function(e,t){return"Total vehicles enters"},label:function(e,t){return t.datasets[e.datasetIndex].label[e.index]+" : $"+t.datasets[e.datasetIndex].data[e.index]}}},plugins:{colorschemes:{scheme:"brewer.Paired12"}}}})))))}}]),t}(o.Component),Q=a(517),$=a(516),Z=a(263),X=a(53),ee=a(522),te=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getFeeds",value:function(){return N.get("/api/feeds")}},{key:"getFeed",value:function(e){return N.get("/api/feed/"+e.ID)}},{key:"addFeed",value:function(e){return N.post("/api/feed/",e)}},{key:"removeFeed",value:function(e){return N.delete("/api/feed/"+e.ID)}},{key:"startFeed",value:function(e){return N.get("/api/feed/"+e.ID+"/start")}},{key:"stopFeed",value:function(e){return N.get("/api/feed/"+e.ID+"/stop")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),ae=a(68),ne=Q.a.Text,re=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,feeds:{}},ae.EventBus.subscribe("feed-refresh",(function(e){return a.refresh()})),a.removeFeed=a.removeFeed.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;te.getFeeds().then((function(t){e.setState({feeds:t.data,loading:!1})}))}},{key:"removeFeed",value:function(e){var t=this;te.removeFeed(e).then((function(){t.refresh()}))}},{key:"startFeed",value:function(e){var t=this;te.startFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"stopFeed",value:function(e){var t=this;te.stopFeed(e).then((function(){t.setState({refresh_state:Math.random()})}))}},{key:"render",value:function(){var e=this,t=this.state.feeds;!this.state.loading&&this.state.feeds&&0!==this.state.feeds.length||(t=[]);var a=$.a.create({name:"feed_form"})(ie);return c.a.createElement(A.a,{gutter:16},t.map((function(t,a){return c.a.createElement(B.a,{span:8,key:a},c.a.createElement(R.a,{title:c.a.createElement(Z.a,{color:"#f50"},t.site,"/",t.location,"/",t.name),cover:c.a.createElement("img",{alt:"feedview",src:"/api/feed/"+t.ID+"/view"}),bordered:!0,actions:[c.a.createElement(X.a,{onClick:function(){e.startFeed(t)}},"Start"),c.a.createElement(X.a,{onClick:function(){e.stopFeed(t)}},"Stop"),c.a.createElement(X.a,{onClick:function(){e.removeFeed(t)}},"Delete")]}))})),c.a.createElement(B.a,{span:8,key:-1},c.a.createElement(R.a,{bordered:!0},c.a.createElement(a,null))))}}]),t}(o.Component);var ie=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault();var t,a=this.props.form,n={};n.url=a.getFieldValue("url"),n.site=a.getFieldValue("site"),n.location=a.getFieldValue("location"),n.name=a.getFieldValue("name"),n.url||(t="Missing url"),n.site||(t="Missing site"),n.location||(t="Missing location"),n.name||(t="Missing name"),t?this.setState({validationError:t}):(console.log("saving feed",n),this.setState({submitted:!0,loading:!0}),te.addFeed(n).then((function(e){ae.EventBus.publish("feed-refresh",{})})))}},{key:"render",value:function(){var e,t=this.props.form,a=t.getFieldDecorator,n=t.getFieldsError,r=this.state.validationError;return c.a.createElement($.a,{onSubmit:this.handleSubmit},c.a.createElement($.a.Item,null,a("url",{rules:[{required:!0,message:"enter feed url!"}]})(c.a.createElement(ee.a,{addonBefore:"Feed\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"rtsp://"}))),c.a.createElement($.a.Item,null,a("site",{rules:[{required:!0,message:"enter site!"}]})(c.a.createElement(ee.a,{addonBefore:"Site\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0",placeholder:"Site (e.g. gurgaon)"}))),c.a.createElement($.a.Item,null,a("location",{rules:[{required:!0,message:"enter location!"}]})(c.a.createElement(ee.a,{addonBefore:"Location",placeholder:"Location (e.g. 9th floor)"}))),c.a.createElement($.a.Item,null,a("name",{rules:[{required:!0,message:"enter name!"}]})(c.a.createElement(ee.a,{addonBefore:"Name\xa0\xa0\xa0\xa0",placeholder:"Name (e.g. front gate )"}))),c.a.createElement(X.a,{htmlType:"submit",type:"primary",disabled:(e=n(),Object.keys(e).some((function(t){return e[t]})))},"Add"),r&&c.a.createElement(ne,{type:"danger"},r))}}]),t}(o.Component),se=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getDevice",value:function(){return N.get("/api/device")}},{key:"getDeviceConfig",value:function(){return N.get("/api/device/config")}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),le=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,device:{}},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;se.getDevice().then((function(t){e.setState({device:t.data,loading:!1})}),(function(e){console.log("error")}))}},{key:"render",value:function(){var e=this.state.loading,t=this.state.device;return e?c.a.createElement("div",null,"Loading.."):c.a.createElement("div",null,c.a.createElement(R.a,{title:"Device details",style:{width:300},extra:c.a.createElement(f.b,{to:"/device/conf"},c.a.createElement(g.a,{type:"setting"}))},c.a.createElement("p",null,"ID: ",t.fingerprint),c.a.createElement("p",null,"Name: ",t.name),c.a.createElement("p",null,"Model: ",t.model),c.a.createElement("p",null,"License: ",t.license),c.a.createElement("p",null,"Status: ",t.status),c.a.createElement("p",null,"RegisteredTo: ",t.registeredTo)))}}]),t}(o.Component),oe=a(514),ce=a(520),ue=a(513),he=(a(475),oe.a.Column),me=Q.a.Text,de=ce.a.confirm,ge=(M.a.Option,X.a.Group,function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).showModal=function(){a.setState({visible:!0})},a.state={loading:!0,users:[],showUserDetails:!1,mode:"Add",user:{userName:"",lastName:"",firstName:"",email:"",password:"",roles:[],id:""},roles:[],visible:!1},a.addUser=a.addUser.bind(Object(z.a)(a)),a.refresh=a.refresh.bind(Object(z.a)(a)),a.refreshUsers=a.refreshUsers.bind(Object(z.a)(a)),a.close=a.close.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;x.getUsers().then((function(t){e.setState({users:t.data,loading:!1,showUserDetails:!1})}),(function(e){U.a.error(e.response.data.message)})),x.getRoles().then((function(t){e.setState({roles:t.data})}),(function(e){U.a.error(e.response.data.message)}))}},{key:"refreshUsers",value:function(){this.refresh()}},{key:"addUser",value:function(){this.setState({mode:"Add",showUserDetails:!0,user:{userName:"",lastName:"",firstName:"",email:"",password:""}})}},{key:"showUser",value:function(e){var t=this;this.setState({showUserDetails:!0,mode:"Edit"}),x.getUser(e).then((function(e){t.setState({user:e.data})}),(function(e){U.a.error(e.response.data.message)}))}},{key:"close",value:function(){this.setState({showUserDetails:!1})}},{key:"showDeleteConfirm",value:function(e,t){de({title:"Are you sure you want to make user inactive?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){console.log("OK"),x.deleteUser(e).then((function(e){U.a.success("User Deactivated!"),t()}),(function(e){U.a.error(e.response.data.message)}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t=$.a.create({name:"user_form"})(fe),a=this.state.showUserDetails;this.state.mode,this.state.user;return c.a.createElement("div",null,c.a.createElement(A.a,{gutter:2},c.a.createElement(B.a,{span:2},c.a.createElement(X.a,{type:"primary",onClick:this.addUser},"+ ADD"))),c.a.createElement("br",null),c.a.createElement(A.a,{gutter:24},c.a.createElement(B.a,{span:12},c.a.createElement(R.a,{className:"limitable",bodyStyle:{padding:"0px",width:"100%"}},c.a.createElement(oe.a,{dataSource:this.state.users,pagination:!1,scroll:{x:!0}},c.a.createElement(he,{title:"Username",dataIndex:"userName",key:"userName",render:function(e,t){return c.a.createElement("span",null,c.a.createElement("a",{href:"user/"+t.ID},e))}}),c.a.createElement(he,{title:"Email",dataIndex:"email",key:"email"}),c.a.createElement(he,{title:"Token",dataIndex:"token",key:"token"}),c.a.createElement(he,{title:"Action",key:"action",render:function(t,a){return c.a.createElement("span",null,c.a.createElement("a",{onClick:e.showUser.bind(e,a.id)},"Edit"),c.a.createElement(ue.a,{type:"vertical"}),c.a.createElement("a",{onClick:e.showDeleteConfirm.bind(e,a.id,e.refresh)},"Delete"))}})))),a?c.a.createElement(B.a,{span:12},c.a.createElement(t,{user:this.state.user,roles:this.state.roles,refresh:this.refreshUsers,close:this.close,mode:this.state.mode})):null))}}]),t}(o.Component)),fe=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={user:{},loading:!1},a.handleSubmit=a.handleSubmit.bind(Object(z.a)(a)),a.close=a.close.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"close",value:function(){this.props.close()}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a,n=this.props.form,r={};r.firstName=n.getFieldValue("firstname"),r.userName=n.getFieldValue("username"),r.lastName=n.getFieldValue("lastname"),r.email=n.getFieldValue("email"),r.password=n.getFieldValue("password"),r.roles=n.getFieldValue("role"),r.id=this.props.user.id,r.firstName||(a="Missing firstname"),r.userName||(a="Missing username"),r.lastName||(a="Missing lastname"),r.email||(a="Missing email"),0==r.roles.length&&(a="Missing role"),a?this.setState({validationError:a}):(this.setState({loading:!0}),console.log("saving user",r),x.createUser(r).then((function(e){r.id?U.a.success("User updated"):U.a.success("User created"),t.setState({loading:!1}),t.props.refresh()})).catch((function(e){console.log(e),t.setState({loading:!1})})))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.validationError;return c.a.createElement(R.a,{title:"Add"==this.props.mode?"Add User":"Edit User"},c.a.createElement($.a,{onSubmit:this.handleSubmit,className:"user-form"},c.a.createElement($.a.Item,{label:"Username",className:"formitem"},e("username",{initialValue:this.props.user.userName,rules:[{required:!0,message:"Please input your username!"}]})(c.a.createElement(ee.a,{type:"text",placeholder:"Username"}))),c.a.createElement($.a.Item,{label:"Firstname",className:"formitem"},e("firstname",{initialValue:this.props.user.firstName,rules:[{required:!0,message:"Please input your Firstname!"}]})(c.a.createElement(ee.a,{type:"text",placeholder:"Firstname"}))),c.a.createElement($.a.Item,{label:"Lastname",className:"formitem"},e("lastname",{initialValue:this.props.user.lastName,rules:[{required:!0,message:"Please input your lastname!"}]})(c.a.createElement(ee.a,{type:"text",placeholder:"Lastname"}))),c.a.createElement($.a.Item,{label:"Email",className:"formitem"},e("email",{initialValue:this.props.user.email,rules:[{required:!0,message:"Please input your email!"}]})(c.a.createElement(ee.a,{type:"email",placeholder:"email"}))),c.a.createElement($.a.Item,{label:"Role",className:"formitem"},e("role",{initialValue:this.props.user.roles,rules:[{required:!0,message:"Please select role!"}]})(c.a.createElement(M.a,{mode:"multiple",placeholder:"Select a role"},this.props.roles.map((function(e){return c.a.createElement("option",{key:e.id,value:e.name},e.name)}))))),c.a.createElement("br",null),c.a.createElement("div",{align:"right"},c.a.createElement(X.a,{type:"primary",htmlType:"submit",className:"user-form-button",size:"small",loading:this.state.loading},"Save"),c.a.createElement("span",null,"\xa0\xa0"),c.a.createElement(X.a,{type:"secondary",className:"user-form-button",size:"small",onClick:this.close},"Close")),t&&c.a.createElement(me,{type:"danger"},t)))}}]),t}(o.Component),pe=a(187),ve=pe.a.TabPane,ye=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,deviceconfig:{}},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;se.getDeviceConfig().then((function(t){e.setState({deviceconfig:t.data,loading:!1})}))}},{key:"onTabChange",value:function(e){console.log("tab changed",e)}},{key:"render",value:function(){return c.a.createElement(pe.a,{defaultActiveKey:"1",onChange:this.onTabChange},c.a.createElement(ve,{tab:"Feed",key:"common"},"Feed details"),c.a.createElement(ve,{tab:"Basic Intrusion",key:"bi"},"Basic Intrusion"),c.a.createElement(ve,{tab:"Advanced Intrusion",key:"ai"},"Advanced Intrusion"))}}]),t}(o.Component),be=a(43),Ee=Object(be.a)(),ke=Q.a.Text,Oe=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){x.isLoggedIn()&&Ee.push("/")}},{key:"render",value:function(){var e=$.a.create({name:"login_form"})(Ce);return c.a.createElement(e,null)}}]),t}(o.Component),Ce=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={username:"",password:"",submitted:!1,loading:!1,loginError:""},a.handleSubmit=a.handleSubmit.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.props.form,n=a.getFieldValue("username"),r=a.getFieldValue("password");this.setState({submitted:!0}),n&&r&&(this.setState({loading:!0}),x.login(n,r).then((function(e){Ee.push("/"),ae.EventBus.publish("login-logout",{})})).catch((function(e){t.setState({loginError:"Something went wrong, please try again",loading:!1})})))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.state.loginError;return c.a.createElement(A.a,null,c.a.createElement(B.a,{span:8,offset:8},c.a.createElement("h4",null,"Login"),c.a.createElement($.a,{onSubmit:this.handleSubmit,className:"login-form"},c.a.createElement($.a.Item,null,e("username",{rules:[{required:!0,message:"Please input your username!"}]})(c.a.createElement(ee.a,{prefix:c.a.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),c.a.createElement($.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(c.a.createElement(ee.a,{prefix:c.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),c.a.createElement($.a.Item,null,c.a.createElement(X.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))),t&&c.a.createElement(ke,{type:"danger"},t)))}}]),t}(o.Component),je=Object(j.g)(Oe),Se=a(136),De=a(519),Te=a(96),we=a(262),Ie=a(261),Ne=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getIncidents",value:function(e){return N.post("/api/incident",e)}},{key:"archiveIncident",value:function(e){return N.delete("/api/incident/"+e.id)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Pe=a(186),Fe=a.n(Pe),xe=a(60),Ve=a.n(xe);function ze(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Le=oe.a.Column,Me=(oe.a.ColumnGroup,De.a.Panel),Ue=X.a.Group,Ae=ce.a.confirm,Be=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,videoVisible:!1,layout:"table",incidents:{},filter:{page:1,pageSize:10}},a.handleDone=a.handleDone.bind(Object(z.a)(a)),a.archiveIncident=a.archiveIncident.bind(Object(z.a)(a)),a.refresh=a.refresh.bind(Object(z.a)(a)),a.onFromDateChange=a.onFromDateChange.bind(Object(z.a)(a)),a.onFromTimeChange=a.onFromTimeChange.bind(Object(z.a)(a)),a.onToDateChange=a.onToDateChange.bind(Object(z.a)(a)),a.onToTimeChange=a.onToTimeChange.bind(Object(z.a)(a)),a.onPageChange=a.onPageChange.bind(Object(z.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;Ne.getIncidents(this.state.filter).then((function(t){e.setState({incidentsresponse:t.data,loading:!1})}),(function(e){U.a.error(e.response.data.message)}))}},{key:"refreshNow",value:function(e){var t=this;Ne.getIncidents(e).then((function(a){t.setState({incidentsresponse:a.data,loading:!1,filter:e})}))}},{key:"archiveIncident",value:function(e){var t=this;Ne.archiveIncident(e).then((function(){t.refresh(),U.a.success("Incident successfully archived!")}),(function(e){U.a.error(e.response.data.message)}))}},{key:"changeLayout",value:function(e){this.setState({layout:e})}},{key:"showVideo",value:function(e){Fe.a.canPlay("/api/incident/video/"+this.state.videoid+"/video.mp4");this.setState({videoVisible:!0,videoid:e})}},{key:"handleDone",value:function(){this.setState({videoVisible:!1,videoid:""})}},{key:"onFromDateChange",value:function(e){var t=this.state.filter;t.fromDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t})}},{key:"onFromTimeChange",value:function(e){var t=this.state.filter;t.fromTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t})}},{key:"onToDateChange",value:function(e){var t=this.state.filter;t.toDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t})}},{key:"onToTimeChange",value:function(e){var t=this.state.filter;t.toTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t})}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"showDeleteConfirm",value:function(e,t){Ae({title:"Are you sure you want to archive the incident ?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){console.log("OK"),Ne.archiveIncident(e).then((function(){t(),U.a.success("Incident successfully archived!")}),(function(e){U.a.error(e.response.data.message)}))},onCancel:function(){console.log("Cancel")}})}},{key:"render",value:function(){var e=this,t=this.state.layout;return c.a.createElement("div",null,c.a.createElement(ce.a,{title:"Video",visible:this.state.videoVisible,onOk:this.handleDone,onCancel:this.handleDone},this.state.videoVisible?c.a.createElement(Fe.a,{controls:!0,url:"/api/incident/video/"+this.state.videoid+"/video.mp4",width:"300"}):c.a.createElement("div",null,c.a.createElement(Te.a,null))),c.a.createElement(De.a,{bordered:!1,defaultActiveKey:["1","2"]},c.a.createElement(Me,{header:"Filter",key:"1"},c.a.createElement("span",null,"From: "),c.a.createElement(L.a,{onChange:this.onFromDateChange}),"\xa0\xa0",c.a.createElement(we.a,{minuteStep:15,secondStep:60,onChange:this.onFromTimeChange}),"\xa0\xa0",c.a.createElement("span",null,"To: "),c.a.createElement(L.a,{onChange:this.onToDateChange}),"\xa0\xa0",c.a.createElement(we.a,{minuteStep:15,secondStep:60,onChange:this.onToTimeChange}),"\xa0\xa0",c.a.createElement(Ue,null,c.a.createElement(X.a,{type:"list"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("list")}}),c.a.createElement(X.a,{type:"table"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("table")}})),"\xa0\xa0",c.a.createElement(X.a,{onClick:function(){e.refresh()}},c.a.createElement(g.a,{type:"reload"}),"Reload")),c.a.createElement(Me,{header:"Incidents",key:"2"},"table"===t?this.renderGrid():this.renderTable())))}},{key:"renderGrid",value:function(){var e=this;if(this.state.loading||!this.state.incidents||0===this.state.incidents.Total)return c.a.createElement(Te.a,{description:!1});var t=this.state.incidentsresponse.incidents,a=this.state.incidentsresponse.totalPages*this.state.incidentsresponse.pageSize;return c.a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},c.a.createElement(A.a,null,c.a.createElement(B.a,null,c.a.createElement(Ie.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize}))),c.a.createElement(A.a,{gutter:16},t.map((function(t,a){return c.a.createElement(B.a,{span:8,key:a},c.a.createElement(R.a,{title:c.a.createElement("div",null,c.a.createElement(Z.a,{color:"#f50"},t.eventType),c.a.createElement(Z.a,{color:"#2db7f5"},t.eventDate),c.a.createElement(Z.a,{color:"#87d068"},c.a.createElement("span",null,c.a.createElement(Ve.a,{format:"LTS"},t.eventStart)),c.a.createElement(g.a,{type:"right",hidden:!0}),c.a.createElement("span",{hidden:!0},c.a.createElement(Ve.a,{format:"LTS"},t.eventEnd))),c.a.createElement(Z.a,{color:"#108ee9",hidden:!0},t.eventDuration,"s")),bordered:!0,cover:c.a.createElement("img",{alt:"incident image",src:"/api/incident/image/"+t.imageId+"/image.jpg"}),actions:[c.a.createElement(g.a,{type:"right",key:"play",onClick:function(){return e.showVideo(t.videoId)}}),c.a.createElement(g.a,{type:"edit",key:"edit"}),c.a.createElement(g.a,{type:"delete",key:"delete",onClick:e.showDeleteConfirm.bind(e,t,e.refresh)})]}))}))))}},{key:"renderTable",value:function(){var e=this;if(this.state.loading||!this.state.incidents||0===this.state.incidents.Total)return c.a.createElement(Te.a,{description:!1});var t=this.state.incidentsresponse.incidents,a=this.state.incidentsresponse.totalPages*this.state.incidentsresponse.pageSize,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ze(a,!0).forEach((function(t){Object(Se.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ze(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:a},{total:a,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return c.a.createElement(oe.a,{dataSource:t,pagination:n},c.a.createElement(Le,{title:"ID",dataIndex:"id",key:"id"}),c.a.createElement(Le,{title:"Type",dataIndex:"eventType",key:"eventType"}),c.a.createElement(Le,{title:"Date",dataIndex:"eventDate",key:"eventDate"}),c.a.createElement(Le,{title:"Time",dataIndex:"eventStart",key:"eventStart",render:function(e){return c.a.createElement(Ve.a,{format:"LTS"},e)}}),c.a.createElement(Le,{title:"Duration",dataIndex:"eventDuration",key:"eventDuration",render:function(e){return c.a.createElement("span",null,e,"s")}}),c.a.createElement(Le,{title:"Action",key:"action",render:function(t,a){return c.a.createElement("span",null,c.a.createElement("a",{onClick:function(){return e.showVideo(a.videoId)}},"Play"),c.a.createElement(ue.a,{type:"vertical"}),c.a.createElement("a",{onClick:e.showDeleteConfirm.bind(e,a,e.refresh)},"Delete"))}}))}}]),t}(o.Component),Ye=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getTrigger",value:function(){return N.get("/api/trigger/")}},{key:"getTriggers",value:function(){return N.get("/api/triggers")}},{key:"createTrigger",value:function(e){return N.post("/api/trigger/",e)}},{key:"saveTrigger",value:function(e){return N.put("/api/trigger/"+e.ID,e)}},{key:"deleteTrigger",value:function(e){return N.delete("/api/trigger/"+e.ID)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance(),Re=a(518),We=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).days=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a.onChange0=a.onChange0.bind(Object(z.a)(a)),a.onChange1=a.onChange1.bind(Object(z.a)(a)),a.onChange2=a.onChange2.bind(Object(z.a)(a)),a.onChange3=a.onChange3.bind(Object(z.a)(a)),a.onChange4=a.onChange4.bind(Object(z.a)(a)),a.onChange5=a.onChange5.bind(Object(z.a)(a)),a.onChange6=a.onChange6.bind(Object(z.a)(a)),a.onChangeValue=a.onChangeValue.bind(Object(z.a)(a)),a.saveTrigger=a.saveTrigger.bind(Object(z.a)(a)),a.deleteTrigger=a.deleteTrigger.bind(Object(z.a)(a)),a.setName=a.setName.bind(Object(z.a)(a)),a.state={trigger:a.props.trigger,changed:!1},a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"onChange0",value:function(e){this.onChangeValue(0,e)}},{key:"onChange1",value:function(e){this.onChangeValue(1,e)}},{key:"onChange2",value:function(e){this.onChangeValue(2,e)}},{key:"onChange3",value:function(e){this.onChangeValue(3,e)}},{key:"onChange4",value:function(e){this.onChangeValue(4,e)}},{key:"onChange5",value:function(e){this.onChangeValue(5,e)}},{key:"onChange6",value:function(e){this.onChangeValue(6,e)}},{key:"onChangeValue",value:function(e,t){var a=this.state.trigger;a.TriggerDays[e].Start=t[0],a.TriggerDays[e].End=t[1],this.setState({trigger:a,changed:!0})}},{key:"saveTrigger",value:function(){this.state.trigger.new?Ye.createTrigger(this.state.trigger):Ye.saveTrigger(this.state.trigger)}},{key:"NewTrigger",value:function(){for(var e={name:"New",TriggerDays:[],new:!0},t=0;t<7;t++)e.TriggerDays.push({Start:0,End:24,Day:t});this.setState({trigger:e,changed:!0})}},{key:"setName",value:function(e,t){var a=this.state.trigger;a.name=e.target.value,this.setState({trigger:a,changed:!0})}},{key:"deleteTrigger",value:function(){Ye.deleteTrigger(this.state.trigger)}},{key:"ChangeTrigger",value:function(e){this.setState({trigger:e,changed:!1})}},{key:"render",value:function(){var e=this.state.trigger,t=this.state.changed;if(!e)return c.a.createElement("div",null,"Waiting..");for(var a={},n=12;n<=24;n++){a[n-12]=n+":00"}for(var r=0;r<=12;r++){a[r+12]=(r<10?"0":"")+r+":00"}e.TriggerDays.map((function(e,t){var a=e.Start,n=e.End;a>n&&(e.Start=a-12,e.End=n+12)}));var i=e.TriggerDays;return c.a.createElement("div",null,e.new?c.a.createElement(ee.a,{placeholder:"Name",onChange:this.setName}):c.a.createElement("span",null,e.ID," - ",e.name),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[0].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[0].Start,i[0].End],onChange:this.onChange0})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[1].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[1].Start,i[1].End],onChange:this.onChange1})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[2].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[2].Start,i[2].End],onChange:this.onChange2})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[3].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[3].Start,i[3].End],onChange:this.onChange3})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[4].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[4].Start,i[4].End],onChange:this.onChange4})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[5].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[5].Start,i[5].End],onChange:this.onChange5})),c.a.createElement("div",null,c.a.createElement("span",null,this.days[i[6].Day]),c.a.createElement(Re.a,{min:0,max:24,range:!0,marks:a,value:[i[6].Start,i[6].End],onChange:this.onChange6})),c.a.createElement(X.a,{type:"primary",disabled:!t,onClick:this.saveTrigger},"Save"),c.a.createElement(X.a,{type:"link",disabled:t,onClick:this.deleteTrigger},"Delete"))}}]),t}(o.Component),qe=M.a.Option,Je=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,triggers:[]},a.tsRef=c.a.createRef(),a.handleChange=a.handleChange.bind(Object(z.a)(a)),a.newTrigger=a.newTrigger.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this;Ye.getTriggers().then((function(t){e.setState({triggers:t.data,selected:t.data[0].ID,selectedt:t.data[0],loading:!1})}))}},{key:"newTrigger",value:function(){this.tsRef.current.NewTrigger()}},{key:"handleChange",value:function(e){console.log("changing to ...",e);for(var t=0;t<this.state.triggers.length;t++)if(console.log("checking:",this.state.triggers[t].ID),e==this.state.triggers[t].ID)return console.log("selected:",e),this.tsRef.current.ChangeTrigger(this.state.triggers[t]),void this.setState({selected:e,selectedt:this.state.triggers[t]});console.log("cant select:(")}},{key:"render",value:function(){var e=this.state.selected,t=this.state.selectedt,a=this.state.triggers;this.state.loading&&(a=[]);var n="";t&&(n=t.Name),console.log("SN",n,e,t);var r=c.a.createElement("div",null,c.a.createElement(M.a,{style:{width:120},onChange:this.handleChange},a.map((function(e,t){return c.a.createElement(qe,{key:e.ID},e.name)}))),"\xa0",c.a.createElement(X.a,{type:"primary",onClick:this.newTrigger},"New"));return t?c.a.createElement("div",null,r,c.a.createElement(We,{trigger:t,ref:this.tsRef})):r}}]),t}(o.Component),He=X.a.Group,Ge=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,layout:"table",filter:{page:1,pageSize:10}},a.onFromDateChange=a.onFromDateChange.bind(Object(z.a)(a)),a.onFromTimeChange=a.onFromTimeChange.bind(Object(z.a)(a)),a.onToDateChange=a.onToDateChange.bind(Object(z.a)(a)),a.onToTimeChange=a.onToTimeChange.bind(Object(z.a)(a)),a.onPageChange=a.onPageChange.bind(Object(z.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(z.a)(a)),a.refresh=a.refresh.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"refresh",value:function(){this.props.handleRefresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"changeLayout",value:function(e){this.setState({layout:e}),this.props.handleLayoutChange(e)}},{key:"onFromDateChange",value:function(e){var t=this.state.filter;t.fromDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onFromTimeChange",value:function(e){var t=this.state.filter;t.fromTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onToDateChange",value:function(e){var t=this.state.filter;t.toDate=null!=e?e.format("YYYY-MM-DD"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"onToTimeChange",value:function(e){var t=this.state.filter;t.toTime=null!=e?e.format("HH:mm:ss"):null,this.setState({filter:t}),this.props.handleFilterChange(t)}},{key:"render",value:function(){var e=this,t=this.state.layout;return c.a.createElement("div",null,c.a.createElement("span",null,"From: "),c.a.createElement(L.a,{onChange:this.onFromDateChange}),"\xa0\xa0",c.a.createElement(we.a,{minuteStep:15,secondStep:60,onChange:this.onFromTimeChange}),"\xa0\xa0",c.a.createElement("span",null,"To: "),c.a.createElement(L.a,{onChange:this.onToDateChange}),"\xa0\xa0",c.a.createElement(we.a,{minuteStep:15,secondStep:60,onChange:this.onToTimeChange}),"\xa0\xa0",c.a.createElement(He,null,c.a.createElement(X.a,{type:"list"===t?"primary":"",size:"small",icon:"unordered-list",onClick:function(){e.changeLayout("list")}}),c.a.createElement(X.a,{type:"table"===t?"primary":"",size:"small",icon:"table",onClick:function(){e.changeLayout("table")}})),"\xa0\xa0",c.a.createElement(X.a,{onClick:function(){e.refresh()}},c.a.createElement(g.a,{type:"reload"}),"Reload"))}}]),t}(o.Component),Ke=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getEvents",value:function(e){return N.post("/api/anpr/events",e)}},{key:"archiveEvent",value:function(e){return N.delete("/api/anpr/"+e.id)}}],[{key:"Instance",value:function(){return new e}}]),e}().Instance();function _e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var Qe=oe.a.Column,$e=De.a.Panel,Ze=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loading:!0,layout:"table",events:{},filter:{page:1,pageSize:10}},a.refresh=a.refresh.bind(Object(z.a)(a)),a.handleFilterChange=a.handleFilterChange.bind(Object(z.a)(a)),a.handleLayoutChange=a.handleLayoutChange.bind(Object(z.a)(a)),a.handleRefresh=a.handleRefresh.bind(Object(z.a)(a)),a.onPageChange=a.onPageChange.bind(Object(z.a)(a)),a.onPageSizeChange=a.onPageSizeChange.bind(Object(z.a)(a)),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;Ke.getEvents(this.state.filter).then((function(t){e.setState({anprresponse:t.data,loading:!1})}))}},{key:"refreshNow",value:function(e){var t=this;Ke.getEvents(this.state.filter).then((function(e){t.setState({anprresponse:e.data,loading:!1})}))}},{key:"handleFilterChange",value:function(e){this.setState({filter:e})}},{key:"handleLayoutChange",value:function(e){this.setState({layout:e})}},{key:"handleRefresh",value:function(){this.refresh()}},{key:"onPageChange",value:function(e,t){var a=this.state.filter;a.page=e,a.pageSize=t,this.refreshNow(a)}},{key:"onPageSizeChange",value:function(e,t){var a=this.state.filter;a.pageSize=t,this.refreshNow(a)}},{key:"render",value:function(){var e=this.state.layout;return c.a.createElement("div",null,"ANPR",c.a.createElement(De.a,{bordered:!1,defaultActiveKey:["1","2"]},c.a.createElement($e,{header:"Filter",key:"1"},c.a.createElement(Ge,{handleRefresh:this.refresh,filter:this.state.filter,layout:e,handleFilterChange:this.handleFilterChange,handleLayoutChange:this.handleLayoutChange})),c.a.createElement($e,{header:"Events",key:"2"},"table"===e?this.renderTable():this.renderGrid())))}},{key:"renderGrid",value:function(){if(this.state.loading||!this.state.anprresponse||0===this.state.anprresponse.totalPage)return c.a.createElement(Te.a,{description:!1});var e=this.state.anprresponse.events,t=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize;return c.a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},c.a.createElement(A.a,null,c.a.createElement(B.a,null,c.a.createElement(Ie.a,{onChange:this.onPageChange,onShowSizeChange:this.onPageSizeChange,showSizeChanger:!0,showQuickJumper:!0,defaultCurrent:1,total:t,current:this.state.filter.page,pageSize:this.state.filter.pageSize}))),c.a.createElement(A.a,{gutter:16},e.map((function(e,t){return c.a.createElement(B.a,{span:8,key:t},c.a.createElement(R.a,{title:c.a.createElement("div",null,c.a.createElement(Z.a,{color:"#2db7f5"},c.a.createElement(Ve.a,{format:"L"},e.eventDate)),c.a.createElement(Z.a,{color:"#87d068"},c.a.createElement("span",null,c.a.createElement(Ve.a,{format:"LTS"},e.eventDate)),c.a.createElement(g.a,{type:"right",hidden:!0}),c.a.createElement("span",{hidden:!0},c.a.createElement(Ve.a,{format:"LTS"},e.eventDate)))),bordered:!0,cover:c.a.createElement("img",{alt:"event",src:"/api/event/image/"+e.vehicleImage+"/image.jpg"})}))}))))}},{key:"renderTable",value:function(){if(this.state.loading||!this.state.events||0===this.state.events.Total)return c.a.createElement(Te.a,{description:!1});var e=this.state.anprresponse.events,t=this.state.anprresponse.totalPages*this.state.anprresponse.pageSize,a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_e(a,!0).forEach((function(t){Object(Se.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_e(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},{showSizeChanger:!0,showQuickJumper:!0,onShowSizeChange:this.onPageSizeChange,onChange:this.onPageChange,total:t},{total:t,current:this.state.filter.page,pageSize:this.state.filter.pageSize});return c.a.createElement(oe.a,{dataSource:e,pagination:a},c.a.createElement(Qe,{title:"ID",dataIndex:"id",key:"id"}),c.a.createElement(Qe,{title:"Date",dataIndex:"eventDate",key:"eventDate",render:function(e){return c.a.createElement(Ve.a,{format:"L"},e)}}),c.a.createElement(Qe,{title:"Time",dataIndex:"eventDate",key:"eventTime",render:function(e){return c.a.createElement(Ve.a,{format:"LTS"},e)}}))}}]),t}(o.Component),Xe=m.a.Content,et=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(i.a)(this,Object(s.a)(t).call(this,e))).state={loggedIn:!1},ae.EventBus.subscribe("login-logout",(function(e){return a.refreshMenu(e)})),a}return Object(l.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.refreshMenu()}},{key:"refreshMenu",value:function(){this.setState({loggedIn:x.isLoggedIn()})}},{key:"render",value:function(){var e=this.state.loggedIn,t=e?c.a.createElement(y,null):null,a=e?c.a.createElement(E,{isLoggedIn:e}):null;return c.a.createElement("div",{className:"App"},c.a.createElement(m.a,null,t,c.a.createElement(m.a,null,a,c.a.createElement(Xe,{style:{margin:"24px 16px 0"}},c.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},c.a.createElement(j.b,{path:"/login",exact:!0,component:je}),c.a.createElement(V,{path:"/",exact:!0,component:_}),c.a.createElement(V,{path:"/incidents",exact:!0,component:Be}),c.a.createElement(V,{path:"/anpr",exact:!0,component:Ze}),c.a.createElement(V,{path:"/user",exact:!0,component:ge}),c.a.createElement(V,{path:"/feed",exact:!0,component:re}),c.a.createElement(V,{path:"/trigger",exact:!0,component:Je}),c.a.createElement(V,{path:"/device",exact:!0,component:le}),c.a.createElement(V,{path:"/device/conf",exact:!0,component:ye}))),c.a.createElement(O,null))))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var tt=function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.a.createElement(f.a,null,c.a.createElement(j.d,null,c.a.createElement(et,null)))}}]),t}(c.a.Component);h.a.render(c.a.createElement(tt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},68:function(e,t){e.exports={EventBus:{events:{},publish:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))},subscribe:function(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}}}}},[[267,1,2]]]);
//# sourceMappingURL=main.14e0ae22.chunk.js.map